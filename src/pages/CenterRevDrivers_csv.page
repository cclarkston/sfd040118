<apex:page controller="ctl_center_rev_drivers" cache="false" contentType="text/csv#center_rev_details_{!current_month_int}_{!current_date_int}_{!current_year_int}.csv" language="en-US"  readonly="true">"Current Month - ({!current_month_int}/{!current_year_int})"
"","","# Days","","","Consults","","","","","GYB Consults","","","","Close Rate","","","","Current Mo","","","","Prior Mo",""
"Center Name","","Worked","","Actual","Budgeted","Var","% Var","","Prior Mo","This Mo","Var","","Actual","Budget","Var","","Starts","Cancelled","GYB Consults","","Starts","Cancelled","GYB Consults"
<apex:repeat value="{!all_centers}" var="center">
"{!center.center_name}","",0,"",{!center.consults_current_month},{!center.budgeted_consults_current_month},{!center.consults_current_month - center.budgeted_consults_current_month},{!if(center.budgeted_consults_current_month==0,0,(center.consults_current_month - center.budgeted_consults_current_month)/center.budgeted_consults_current_month * 100)},"",{!if(center.consults_last_month==0,0,center.gyb_consults_last_month/center.consults_last_month * 100)},{!if(center.consults_current_month==0,0,center.gyb_consults_current_month/center.consults_current_month * 100)},{!if(center.consults_last_month==0,0,center.gyb_consults_last_month/center.consults_last_month * 100) - if(center.consults_current_month==0,0,center.gyb_consults_current_month/center.consults_current_month * 100)},"",{!if(center.consults_current_month==0,0,(center.starts_current_month - center.cancels_current_month)/center.consults_current_month * 100)},{!center.budgeted_close_rate_current_month},{!if(center.consults_current_month==0,0,(center.starts_current_month - center.cancels_current_month)/center.consults_current_month * 100) - center.budgeted_close_rate_current_month},"",{!center.starts_current_month},{!center.cancels_current_month},{!center.gyb_consults_current_month},"",{!center.starts_last_month},{!center.cancels_last_month},{!center.gyb_consults_last_month}
</apex:repeat>

"Last Month - ({!last_month_name}/{!last_year_int})"
"","","# Days","","","Consults","","","","","GYB Consults","","","","Close Rate","","","","{!last_month_name}-{!last_year_int}","","","","{!two_month_name}-{!two_year_int}",""
"Center Name","","Worked","","Actual","Budgeted","Var","% Var","","{!two_month_name}-{!two_year_int}","{!last_month_name}-{!last_year_int}","Var","","Actual","Budget","Var","","Starts","Cancelled","GYB Consults","","Starts","Cancelled","GYB Consults"
<apex:repeat value="{!all_centers}" var="center">
"{!center.center_name}","",0,"",{!center.consults_last_month},{!center.budgeted_consults_last_month},{!center.consults_last_month - center.budgeted_consults_last_month},{!if(center.budgeted_consults_last_month==0,0,(center.consults_last_month - center.budgeted_consults_last_month)/center.budgeted_consults_last_month * 100)},"",{!if(center.consults_two_month==0,0,center.gyb_consults_two_month/center.consults_two_month * 100)},{!if(center.consults_last_month==0,0,center.gyb_consults_last_month/center.consults_last_month * 100)},{!if(center.consults_two_month==0,0,center.gyb_consults_two_month/center.consults_two_month * 100) - if(center.consults_last_month==0,0,center.gyb_consults_last_month/center.consults_last_month * 100)},"",{!if(center.consults_last_month==0,0,(center.starts_last_month - center.cancels_last_month)/center.consults_last_month * 100)},{!center.budgeted_close_rate_last_month},{!if(center.consults_last_month==0,0,(center.starts_last_month - center.cancels_last_month)/center.consults_last_month * 100) - center.budgeted_close_rate_last_month},"",{!center.starts_last_month},{!center.cancels_last_month},{!center.gyb_consults_last_month},"",{!center.starts_two_month},{!center.cancels_two_month},{!center.gyb_consults_two_month}</apex:repeat>

</apex:page>