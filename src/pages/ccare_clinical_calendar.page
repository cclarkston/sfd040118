<apex:page showheader="false" sidebar="false" standardStylesheets="false" controller="dp_clinical_calendar" docType="html-5.0" action="{!check_for_weather_data}">
<head>
  <meta charset="UTF-8" />
  <title>HopeRx</title>
    <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/dp_css_main.css')}"/>  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous"/>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,600' rel='stylesheet' type='text/css' />
  
  <!-- <apex:stylesheet value="{!URLFOR($Resource.Modal_Resources,'modal/style.css')}" />
  <apex:includeScript value="{!URLFOR($Resource.Modal_Resources,'modal/script.js')}"/>-->
  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/mmenu_nav.css')}"/>
  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/cc.css')}"/>   
  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/dp_css_main.css')}"/>  
  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/fonts.css')}"/>
  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/forms.css')}"/>    
  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/cc-buttons.css')}"/>  

  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/cc-clinical-calendar.css')}"/>  
  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/cc-clinical.css')}"/> 
  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/cc-patient.css')}"/> 
  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/cc-pot.css')}"/> 
  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/cc-modal.css')}"/> 
  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/style.css')}"/>   
  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/cc-calendar-blocks.css')}"/>   
  <apex:stylesheet value="{!URLFOR($Resource.Dental_Practice_Resources, 'css/cc-hrxfont.css')}"/>
  
  <script>
var $j = jQuery.noConflict();
// $j is now an alias to the jQuery function; creating the new alias is optional.  
</script> 
  <apex:includeScript value="{!URLFOR($Resource.Modal_Resources,'modal/cc-clinical-calendar-modal.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.Modal_Resources,'modal/cc-patient.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.Modal_Resources,'modal/cc-schedule.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.Modal_Resources,'modal/cc-modal.js')}"/>
 
</head>
<style type="text/css" media="print">
  * {transition: none !important}

  .no-print {
    display:none !important;
  }
  
  .print-only {
    display:flex !important;
  }
  
  .cc-cc-datepicker {
    font-size:10px !important;    
  }
  
  .cc-cc-datepicker::-webkit-inner-spin-button,
  .cc-cc-datepicker::-webkit-calendar-picker-indicator {
    display: none;
    -webkit-appearance: none;
  }
  
  .cc-content-wrapper {
    margin-top:0px;
  }
  
  .cc-clinical-calendar-schedule-cell-time-container {
    max-height:11px !important;
    min-height:11px !important;
    font-size:7px !important;
  }
  
  .cc-clinical-calendar-schedule-cell-time-container-generic {
    max-height:11px !important;
    min-height:11px !important;
    font-size:7px !important;
    margin-top:0 !important;
    margin-bottom:0 !important;
  }
  
  .cc-clinical-calendar-schedule-cell-time-container-generic i {
    font-size:7px !important;
  }
  
  .pad-main-wrapper {
    margin-top:0;
  }
</style>

<style>

.cal_footer {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 30px;
  z-index: 12000;
  width: 250px;
  background: #51a1a1;
  color: white;
  font-weight: bold;
  border-top-right-radius: 5px;
  padding-top: 3px;
  padding-left: 10px;
}

.cc-clinical-calendar-schedule-cell-time-container {
  position:relative;
  z-index:1;
}

.cc-blockTime-sched-button {
  font-size: 14pt;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    background-color: rgba(91, 91, 91, 0.75);
    padding-top: 5px;
    padding-bottom: 5px;
    padding-left: 15px;
    padding-right: 15px;
    color: white;
    margin: 10px;
    cursor:pointer;
    height:35px;
}    

.cc-modal-patientInfo-confirmation select {
    border: 1px dotted black;
    font-size: 12pt;
    font-family: 'Open Sans', sans-serif;
    font-weight: 300;
    background-color: transparent;
    outline: 0;
    margin-left: 20px;
}

.cc-calendar-scheduling-action-extend:hover {
  background-color:rgb(58, 162, 162);
  transition:.25s;
  color:white;
}

.cc-calendar-scheduling-action-extend {
  border:1px solid rgb(58, 162, 162);
  color: rgb(58, 162, 162);
}

.cc-calendar-scheduling-action-reduce:hover {
  background-color:#bf3131;
  transition:.25s;
  color:white;
}

.cc-calendar-scheduling-action-reduce {
  border:1px solid #bf3131;
  color: #bf3131;
}

.cc-calendar-scheduling-action-sroom:hover {
  background-color:#8f5f84;
  transition:.25s;
  color:white;
}

.cc-calendar-scheduling-action-sroom {
  border:1px solid #8f5f84;
  color: #8f5f84;
}

.cc-calendar-scheduling-action-sdoc:hover {
  background-color:#58595b;
  transition:.25s;
  color:white;
}

.cc-calendar-scheduling-action-sdoc {
  border:1px solid #58595b;
  color: #58595b;
}

.cc-calendar-scheduling-action-mresched:hover {
  background-color:#f17834;
  transition:.25s;
  color:white;
}

.cc-calendar-scheduling-action-mresched {
  border:1px solid #f17834;
  color: #f17834;
}

.cc-calendar-scheduling-action-achange:hover {
  background-color:#915858;
  transition:.25s;
  color:white;
}

.cc-calendar-scheduling-action-achange {
  border:1px solid #915858;
  color: #915858;
}

.cc-cc-apptInfoHover {
  top:initial;
}

cc-cc-apptInfoHover:after, .cc-cc-weekInfoHover:after {
  opacity:0;
}

.cc-clinical-calendar-schedule-cell-header {
   height:35px;
 }

  .cal_table_holder {
    border: 1px solid #0a66e0;
    margin-top: 10px;
  }
  
  .cc-cc-datepicker {
    min-width:175px;
  }
  
  .calendar {
    font-size:8pt;
    width:100%;
  }
  
  .calendar td {
    padding-left:6px;
    padding-right:6px;
    padding-top:2px;
    padding-bottom:2px;
    text-align:center;
  }
  
  .calendar td.selected {
    background: rgb(175, 211, 221);
    border:1px solid #999999;
  }
  
  .calendar .cheader {
    background:#eee;
    border-bottom:1px solid #ccc;
  }

  .mcal_nav_box {
    border: 1px solid #cccccc;
    background: #eee;
    display: flex;
    align-items: center;
    padding: 4px;
  }
  
  .mcal_nav_box i {
    font-size: 5pt;
    color: #555555;
  }



  .print-only {
    display:none;
  }
  
  .modal_cal_container {
    position: absolute;
    margin-left: -1px;
    z-index: 7300;
    background: white;
    padding: 8px;
    border: 1px solid #ccc;
    min-width:190px;
  }
  
  .calendar_name {
    display: flex;
    flex-direction: row;
  }
  
  .month_name {
    font-size:10pt;
    display:flex;
    flex-grow:1;
  }
  
  .year_name {
    font-size:10pt;
  }

.cc-clinical-calendar-schedule-cell-time-container-generic .cc-clinical-calendar-schedule-cell-time-blocked {
  padding-left:0;
}

.cc-clinical-calendar-schedule-cell-time-blocked {
  border-color:#cccccc;
  border-left:1px solid black;
  border-right:1px solid black;
}

.top-cell {
  border-top:1px solid black;
}

.bottom-cell {
  border-bottom:1px solid black;
}

.cc-clinical-calendar-schedule-cell-time-blocked .cc-cc-calendar-cell-content {
background: -webkit-linear-gradient(45deg, rgba(0,0,0,0) 0, rgba(0,0,0,0) 15%, rgba(224,231,246,1) 16%, rgba(224,231,246,1) 26%, rgba(255,255,255,0.2) 27%, rgba(0,0,0,0) 45%, rgba(224,231,246,1) 46%, rgba(224,231,246,1) 56%, rgba(0,0,0,0) 57%, rgba(0,0,0,0) 76%, rgba(224,231,246,1) 76%, rgba(224,231,246,1) 87%, rgba(0,0,0,0) 88%, rgba(0,0,0,0) 100%), rgb(255,255,255);
background: -moz-linear-gradient(45deg, rgba(0,0,0,0) 0, rgba(0,0,0,0) 15%, rgba(224,231,246,1) 16%, rgba(224,231,246,1) 26%, rgba(255,255,255,0.2) 27%, rgba(0,0,0,0) 45%, rgba(224,231,246,1) 46%, rgba(224,231,246,1) 56%, rgba(0,0,0,0) 57%, rgba(0,0,0,0) 76%, rgba(224,231,246,1) 76%, rgba(224,231,246,1) 87%, rgba(0,0,0,0) 88%, rgba(0,0,0,0) 100%), rgb(255,255,255);
background: linear-gradient(45deg, rgba(0,0,0,0) 0, rgba(0,0,0,0) 15%, rgba(224,231,246,1) 16%, rgba(224,231,246,1) 26%, rgba(255,255,255,0.2) 27%, rgba(0,0,0,0) 45%, rgba(224,231,246,1) 46%, rgba(224,231,246,1) 56%, rgba(0,0,0,0) 57%, rgba(0,0,0,0) 76%, rgba(224,231,246,1) 76%, rgba(224,231,246,1) 87%, rgba(0,0,0,0) 88%, rgba(0,0,0,0) 100%), rgb(255,255,255);
background-repeat: repeat-x;
-webkit-background-origin: padding-box;
background-origin: padding-box;
-webkit-background-clip: border-box;
background-clip: border-box;
-webkit-background-size: 150px 20px;
background-size: 150px 20px;
-webkit-box-shadow: none;
color:black;
font-weight:bold;
}


.cc-sub-nav-cell [class^="ccf-"], [class*=" ccf-"] {
  line-height:1.2;
}

.weather_tooltip {
  position: relative;
}

.weather_tooltip .weather_tiptext {
  visibility: hidden;
  width: 150px;
  background-color: white;
  text-align: center;
  padding: 5px 0;
  border-radius: 6px;
  border:1px solid black;
   
  position: absolute;
  z-index: 1;  
  top: 100%;
  left: 50%; 
  margin-left: -75px;
  font-size:11pt;
}

.weather_tooltip .extended {
  visibility: hidden;
  width: initial !important;
  background-color: white;
  text-align: center;
  padding: 5px 0;
  border-radius: 6px;
  border:1px solid black;
  padding-right:5px;
  padding-left:5px;
  position: absolute;
  z-index: 1;  
  top: 100%;
  left: 50%; 
  margin-left: -75px;
  font-size:11pt;
}

.weather_tooltip:hover .weather_tiptext {
  visibility: visible;
}

.cc-back-container {
  display: flex;
  flex-direction: row;
}

.cc-nav-wrapper {
  z-index:10000;
}

.cc-modal-searchResults-lab-button-ok-old {
  background-color:rgb(15, 167, 7);
}

.cc-modal-searchResults-lab-button-med-old {
  background-color:rgb(207, 158, 11);
}

.cc-modal-searchResults-lab-button-full-old {
  background-color:rgb(214, 42, 42);

}

.cc-modal-searchResults-lab-button-old {
  color:white;
  display:flex;
  justify-content: center;
  align-items: center;
  padding-left:10px;
  padding-right:10px;
  padding-top:3px;
  padding-bottom:3px;
  border-radius:4px;
  transform:translateY(-15%);
}

.cc-modal-searchResults-date-container-old {
  font-size:16pt;
  font-weight:300;
  letter-spacing: 1px;
  transform:translateY(-15%);
}

.cc-modal-searchResults-header-old {
  display:flex;
  border-bottom:1px solid #666666;
  width:75%
}


.cc-modal-searchResults-lab-icon-old {
    margin-right:4px;
}

.cc-modal-searchResults-lab-container-old {
  display:flex;
  align-items: flex-end;
  flex-grow:1;
  justify-content: flex-end;
}

  body {
    font-family: 'Open Sans', sans-serif;
  }
  
  .cc-modal-phone-checkbox {
    display:inline-flex;
  }
  
  .cc-cc-apptInfoHover {
    display:none;
  }
  
  .cc-cc-calendar-cell-content:hover .cc-cc-apptInfoHover {
    display:block;
  }  
  
  .cc-toolbar-button-icon-container:hover .cc-toolbar-button-icon-tooltip {
    display:block;
    opacity:1;
  }
  
  .pad-right {
    padding-right:15px;
  }
  
  .pad-main-wrapper {
    margin-top:145px;
  }
  
  .cc-block-available {
    color:rgba(1,1,1,0);
  }
  
  .cc_calendar_block_open {
    background-color: rgba(195, 155, 160, .25) !important;    
    transition: .25s;
    z-index: 2000 !important;
    color:rgba(1,1,1,0);
  }
  
  .cc-calendar-scheduling-action-confirmCancel-disabled {
    cursor: not-allowed;
  }
  
  .working_slot {
       background:#fffef2;
       padding-left:10px;
       border-right:2px solid #e6d400;
       border-left:2px solid #e6d400;
       border-bottom:1px solid #fffef2;
       margin-top:-1px;
       min-hieght:21px;
       max-height:21px;
       <!--z-index:3;-->
    }
    
    .working_head {
       background:#fffef2;
       padding-left:10px;
       border-top:2px solid #e6d400;
       border-right:2px solid #e6d400;
       border-left:2px solid #e6d400;
           <!--  z-index:3;-->
    }
    
    .working_close {
       background:#fffef2;
       padding-left:10px;

       border-right:2px solid #e6d400;
       border-left:2px solid #e6d400;
       border-bottom:2px solid #e6d400;
<!--                     z-index:3;-->
    }
    
    .no_bottom {
      border-bottom:0px;
    }
    
    .clip_board_outer_hidden {
      position: fixed;
      left: 0px;
      top: 200px;
      z-index: 20000;
      padding: 0px;
      padding-left: 0;
      border: 2px solid #337ab7;
      min-height: 300px;
      max-height:300px;
      border-bottom-right-radius: 10px;
      border-top-right-radius: 10px;
      border-left:0px;
      background: #f5f5f5;
      width: 40px;      
    }
    
    .clip_board_outer {
      position: fixed;
      left: 0px;
      top: 200px;
      z-index: 20000;
      padding: 0px;
      padding-left: 0;
      border: 2px solid #337ab7;
      min-height: 300px;
      max-height:300px;
      border-bottom-right-radius: 10px;
      border-top-right-radius: 10px;
      border-left:0px;
      background:white;      
    }
    
    .clip_board_content {
      display: flex;
      flex-direction: column;
    }
    
    .clip_board_content_hidden {
      visibility:hidden;
    }
    
    .sresults_header {
      display:flex;
    }
    
    .clip_board_inner {
      min-height: 297px;
      max-height:297px;
      border: 2px solid rgba(51, 122, 183, 0.52);
      border-bottom-right-radius: 10px;
      border-top-right-radius: 9px;
      border-left: 0;
      padding: 5px;
      overflow:auto;
    }
    
    .clip_board_header {
      position: absolute;
      top: -20px;
      font-weight: 500;
      font-size: 10pt;
      width:150px;
    }
    
    .clip_icon {
      display: inline-block;
      background: #666666;
      color: white;
      padding-left: 2px;
      padding-right: 2px;
      align-items: center;
      font-size: 8pt;
      position: relative;
      top: -1px;
      cursor: pointer;
    }
    
    .clip_icon i {
      position: relative;
      left: -1px;
      top: 1px;
    }
    
    .clip_board_header_text {
      background: white;
      padding-right: 5px;
      padding-left: 3px;
    }
    
    .clip_item_odd { 
      display: flex;
      flex-direction: row;
      padding-left: 10px;
      padding-right: 10px;
      padding-top: 5px;
      padding-bottom: 5px;
      background: #eee;
      border-bottom: 2px solid #ccc;
      font-style:italic;
    }
            
    .clip_item_even { 
      display: flex;
      flex-direction: row;
      padding-left: 10px;
      padding-right: 10px;
      padding-top: 5px;
      padding-bottom: 5px;
    }
    
    .clip_item_actions {      
      align-items: center;
      justify-content: center;
      display: flex;
    }
    
    .clip_item_actions i {
      font-size: 16pt;
      padding-right:10px;
    }
    
    .clip_item_details {
      flex-direction: column;
      display: flex;
      width:80%;
      padding-right:20px;
    }
    
    .clip_item_name { }
    
    .clip_item_apt {  }
    
    .clip_item_pot {}
    
    .clip_board_outer .clip_hidden_text {
      display:inline;
    }
    
    .clip_board_outer_hidden .clip_hidden_text {
      display:none;
    }
    
    select option { color: black; }
</style>

<script>
  /*function hide_patient_tooltip(x) {
    //$j(x).prev().css("display","none");
    $j(x).next().css("display","none");
  }
  
  function display_patient_tooltip(x) {
  //  $j(x).prev().css("display","block");
    $j(x).next().css("display","block");
  }*/
  
  function confirmation_hide_patient_tooltip(x) {
    $j(x).prev().css("opacity","0");
    $j(x).prev().css("z-index","-1000");
  }
  
  function confirmation_display_patient_tooltip(x) {
    $j(x).prev().css("opacity","1");
    $j(x).prev().css("z-index","15000");    
  }  
  
  function tooltip_show_test(x) {
    $j(x).children("p").css("opacity","1");
    $j(x).children("p").css("visibility","visible");
    $j(x).children("p").css("z-index","15000");
  }
  
  function tooltip_hide_test(x) {
    $j(x).children("p").css("opacity","0");
    $j(x).children("p").css("visibility","hidden");
    //$j(x).children("p").css("z-index","-1000");
  }   
  
  var apt_search_timeout;
  var apt_search_in_progress = false;
  var current_room_id;
  var current_time;
  var key_timeout;
  var search_in_progress = false;
  
  function apt_qsearch_key(e) {
    if(search_in_progress)
      clearTimeout(key_timeout);
    search_in_progress = true;
    key_timeout = setTimeout("apt_change_refresh()",600);
  }
  
  function override_manual_modal(apt_id,ctime) {
    //alert('Room Id : ' + apt_id + '\r\nTime : ' + ctime);
    open_manual_modal(apt_id,ctime);
  }
  
  function standard_manual_modal() {
    //alert('test');
    //alert('Room Id : ' + current_room_id + '\r\nTime : ' + current_time);
    open_manual_modal(current_room_id,current_time);
  }
  
  function apt_search_delay() {    
    if(apt_search_in_progress)
      clearTimeout(apt_search_timeout);
    apt_search_in_progress = true;  
    apt_search_timeout = setTimeout("search_apts()",1200);
  }   
  
  
  function display_good_msched(obj,rid,ctime) {
    var holder = $j(obj);
    holder = holder.closest('.cc-clinical-calendar-schedule-cell-time-container-generic');
    //alert(holder.attr('class'));
    var block = $j('#cc-schedule-block-container');
    block.css('display', 'block');
    block.css('background-color', 'rgba(250, 216, 249, 1)');
    block.css('color', 'black');
    block.css('border-color', 'rgba(236, 119, 238, 1)');
    block.css('cursor', 'pointer');   
    holder.append(block);
    current_room_id = rid;
    current_time = ctime;
    //alert('Done');
  }
  
  function print_a_section(divName) {
    var printContents = document.getElementById(divName).innerHTML;
    var originalContents = document.body.innerHTML;

    //document.body.innerHTML = '<style>.narrative_label {font-weight:bold;}.narrative_section {padding-bottom:1em;}</style><div class="cc-form-header-container"><div class="cc-form-header">' + pname + '</div></div>' + printContents;
    document.body.innerHTML = '<div style="padding-top:1em;width:100%;">' + printContents + '</div>';
    window.print();

    document.body.innerHTML = originalContents;
  }
   
  function display_bad_msched(obj,rid,ctime) {
    try {
    var holder = $j(obj);
    holder = holder.closest('.cc-clinical-calendar-schedule-cell-time-container-generic');
    //alert(holder.attr('id'));
    var block = $j('#cc-schedule-block-container');
    block.css('display', 'block');
    block.css('background-color', 'rgba(200, 60, 60, 1)');
    block.css('color', 'white');
    block.css('border-color', 'red');
    block.css('cursor', 'not-allowed');
    holder.append(block);
    current_room_id = rid;
    current_time = ctime;
    //alert('Done');
    } catch(err) {
      alert(err.message);
      console.log(err.message);
    }
  }
  
  function resize_textarea() {
    $j("textarea").each(function(){
      this.style.height = 'auto';
      this.style.height = this.scrollHeight+'px';
    });
  }
  
  function display_noncell_msched(obj,rid,ctime) {
    try {
    var holder = $j(obj);
    holder = holder.closest('.cc-clinical-calendar-schedule-cell-time-container-generic');
    //alert(holder.attr('id'));
    var block = $j('#cc-schedule-block-container');
    block.css('display', 'block');
    block.css('background-color', 'rgba(133, 115, 140, 1)');
    block.css('color', 'white');
    block.css('border-color', 'black');
    block.css('cursor', 'not-allowed');
    holder.append(block);
    current_room_id = rid;
    current_time = ctime;
    //alert('Done');
    } catch(err) {
      alert(err.message);
      console.log(err.message);
    }
  }
  
  $(function() {
    /*
     * this swallows backspace keys on any non-input element.
     * stops backspace -> back
     */
    var rx = /INPUT|SELECT|TEXTAREA/i;

    $(document).bind("keydown", function(e){
        //alert('Alert Pressed : ' + e.which);
        if( e.which == 8 ){ // 8 == backspace
            if(!rx.test(e.target.tagName) || e.target.disabled || e.target.readOnly ){
                e.preventDefault();
            }
        }
        if(e.which== 116) {
          e.preventDefault();
        }
    });
});

  function show_clipboard(obj) {
    //$j(obj).removeClass('clip_board_outer_hidden');
    //$j(obj).addClass('clip_board_outer');
    $j(obj).css('width','400px');          
    $j('#clip_content').removeClass('clip_board_content_hidden');
  }
  
  function hide_clipboard(obj) {    
    //$j(obj).removeClass('clip_board_outer');
    //$j(obj).addClass('clip_board_outer_hidden');
    $j(obj).css('width','40px');
    $j('#clip_content').addClass('clip_board_content_hidden');
  }

  /*function show_clipboard(obj) {
    $j(obj).removeClass('clip_board_outer_hidden');
    $j(obj).addClass('clip_board_outer');          
    $j('#clip_content').removeClass('clip_board_content_hidden');
  }
  
  function hide_clipboard(obj) {    
    $j(obj).removeClass('clip_board_outer');
    $j(obj).addClass('clip_board_outer_hidden');
    $j('#clip_content').addClass('clip_board_content_hidden');
  }*/
</script> 

<body>
<apex:form >
<apex:outputpanel styleclass="cc-wrapper" layout="block">

<apex:outputpanel layout="block" id="clipboard_out" styleclass="clip_board_outer_hidden no-print" onmouseover="show_clipboard(this);" onmouseout="hide_clipboard(this);">
  <div class="clip_board_inner">
    <p class="clip_board_header">      
      <span class="clip_board_header_text">
        <span class="clip_hidden_text">Clipboard </span>{!clipboard_header}</span>
    </p>
    <span id="clip_content" class="clip_board_content clip_board_content_hidden" >
      <apex:variable var="rowclassname" value="odd" />
      <apex:repeat var="clip" value="{!clipboard}">
        <apex:outputpanel styleclass="clip_item_{!rowclassname}">
          <span class="clip_item_details">
            <span class="clip_item_name">{!clip.hippa_name}</span>
            <span class="clip_item_apt">{!clip.apt.name}</span>
            <span class="clip_item_pot">{!clip.apt.patient_pot__r.name}</span>
            <apex:variable var="rowclassname" value="{!if(rowclassname=='odd','even','odd')}" />
          </span>
          <span class="clip_item_actions">
            <i class="ccf-calendar" onclick="sched_from_board('{!clip.apt.id}');"></i>
            <apex:outputpanel rendered="{!clip.allow_delete}"><i class="ccf-trash" onclick="remove_from_board('{!clip.board.id}');"></i></apex:outputpanel>
          </span>
        </apex:outputpanel>
      </apex:repeat>
    </span>
  </div>
</apex:outputpanel>


<apex:actionFunction name="toggle_clipboard" action="{!toggle_clipboard_display}" status="ajaxstatus" rerender="clipboard_out" />
<apex:actionFunction name="add_to_board" action="{!add_to_clipboard}" rerender="clipboard_out,calendar_holder,calendar_nav,main_holder"  status="ajaxstatus">
  <apex:param name="cbid" value=""  />
</apex:actionFunction>
<apex:actionFunction name="conf_add_to_board" action="{!confirm_add_to_clipboard}" rerender="main_holder"  status="ajaxstatus">
  <apex:param name="cbid" value=""  />
</apex:actionFunction>
<apex:actionFunction name="sched_from_board" action="{!sched_from_clipboard}" rerender="main_holder,clipboard_out" status="ajaxstatus" >
  <apex:param name="cbid" value="" />  
</apex:actionFunction>
<apex:actionFunction name="remove_from_board" action="{!remove_from_clipboard}" rerender="main_holder,clipboard_out" status="ajaxstatus" >
  <apex:param name="cbid" value="" />  
</apex:actionFunction>

<apex:actionFunction name="apt_select" action="{!select_appointment}" rerender="calendar_modal_holder" status="ajaxstatus" >
  <apex:param name="aptid" value="" />
</apex:actionFunction> 

<apex:actionFunction name="next_page" rerender="apt_search_results_holder" action="{!apt_search_next_page}" status="ajaxstatus" />
<apex:actionFunction name="prev_page" rerender="apt_search_results_holder" action="{!apt_search_prev_page}" status="ajaxstatus" />

<apex:actionFunction name="body_refresh" rerender="calendar_nav,main_holder" status="ajaxstatus"/>
<apex:actionFunction name="apt_change_refresh" rerender="apt_change_form" status="ajaxstatus"/> 
<apex:actionFunction name="show_apt_change_form" action="{!display_appointment_change_form}" rerender="calendar_modal_holder" status="ajaxstatus"/>
<apex:actionFunction name="nav_bar_refresh" rerender="nav_cdisplay_appointment_change_formontent" />
<apex:actionFunction name="calendar_refresh" rerender="calendar_nav,calendar_holder" status="ajaxstatus"/>
<apex:actionFunction name="cdate_change" action="{!calendar_date_change}" rerender="calendar_nav,main_holder" status="ajaxstatus"/>
<apex:actionFunction name="nav_to" action="{!navigate_to}" rerender="none"  >
  <apex:param name="navid" value=""  />
</apex:actionFunction>
<apex:actionFunction name="nav_to_recent" action="{!navigate_to_recent_patient}" rerender="none" >
  <apex:param name="recentid" value=""  />
</apex:actionFunction>
<apex:actionFunction name="center_switch" action="{!change_center}" rerender="nav_content,main_holder" status="ajaxstatus" >
  <apex:param name="cid" value="" />
</apex:actionFunction>
<apex:actionFunction name="refresh_incomplete_button" rerender="incomplete_button_holder" status="ajaxstatus" />
<apex:actionFunction name="refresh_cancel_button" rerender="cancel_button_holder" status="ajaxstatus" />
<apex:actionFunction name="refresh_reschedule_button" rerender="reschedule_button_holder" status="ajaxstatus" />
<apex:actionFunction name="set_default_view" action="{!save_default_view}" rerender="none" status="ajaxstatus" />
<apex:actionFunction name="open_cmodal" action="{!open_calendar_modal}" rerender="main_holder" status="ajaxstatus" >
  <apex:param name="aptid" value="" />
</apex:actionFunction>
<apex:actionFunction name="close_cmodal" action="{!close_calendar_modal}" rerender="main_holder" status="ajaxstatus" />
<apex:actionFunction name="update_cstatus" action="{!update_confirmation_status}" rerender="cc-modal-template" status="ajaxstatus" />
<apex:actionFunction name="mark_arrived" action="{!mark_apt_arrived}" rerender="main_holder" status="ajaxstatus" >
  <apex:param name="aptid" value="" />
</apex:actionFunction>
<apex:actionFunction name="mark_ready" action="{!mark_apt_ready}" rerender="main_holder" status="ajaxstatus">
  <apex:param name="aptid" value="" />
</apex:actionFunction>
<apex:actionFunction name="mark_started" action="{!mark_apt_started}" rerender="main_holder" status="ajaxstatus">
  <apex:param name="aptid" value="" />
</apex:actionFunction>
<apex:actionFunction name="mark_completed" action="{!mark_apt_completed}" rerender="main_holder" status="ajaxstatus" >
  <apex:param name="aptid" value="" />
</apex:actionFunction>
<apex:actionFunction name="mark_incomplete" action="{!mark_apt_incomplete}" rerender="main_holder" status="ajaxstatus" >
  <apex:param name="aptid" value="" />
</apex:actionFunction>
<apex:actionFunction name="mark_reset" action="{!mark_apt_reset}" rerender="main_holder" status="ajaxstatus" >
  <apex:param name="aptid" value="" />
</apex:actionFunction>
<apex:actionFunction name="mark_left" action="{!mark_apt_left}" rerender="main_holder" status="ajaxstatus" >
  <apex:param name="aptid" value="" />
</apex:actionFunction>
<apex:actionFunction name="mark_no_show" action="{!mark_apt_no_show}" rerender="main_holder" status="ajaxstatus" >
  <apex:param name="aptid" value="" />
</apex:actionFunction>
<apex:actionFunction name="incomplete_reason" action="{!incomplete_reason_view}" rerender="cc-modal-template" status="ajaxstatus">
  <apex:param name="aptid" value="" />
</apex:actionFunction>

<apex:actionFunction name="extend_block" action="{!extend_apt_block}" rerender="main_holder" status="ajaxstatus">
  <apex:param name="aptid" value="" />
</apex:actionFunction>
<apex:actionFunction name="reduce_block" action="{!reduce_apt_block}" rerender="main_holder" status="ajaxstatus">
  <apex:param name="aptid" value="" />
</apex:actionFunction>

<apex:actionFunction name="switch_room_v" action="{!switch_room_view}" rerender="cc-modal-template" status="ajaxstatus" >
  <apex:param name="aptid" value="" />
</apex:actionFunction>
<apex:actionFunction name="switch_doc_v" action="{!switch_doctor_view}" rerender="cc-modal-template" status="ajaxstatus" >
  <apex:param name="aptid" value="" />
</apex:actionFunction>

<apex:actionFunction name="confirm_room_switch" action="{!perform_room_switch}" rerender="main_holder" status="ajaxstatus">
  <apex:param name="aptid" value="" />
  <apex:param name="roomid" value="" />
</apex:actionFunction>
<apex:actionFunction name="confirm_doctor_switch" action="{!perform_doctor_switch}" rerender="main_holder" status="ajaxstatus">
  <apex:param name="aptid" value="" />
  <apex:param name="docid" value="" />
</apex:actionFunction>


<apex:actionFunction name="cancel_reason" action="{!cancel_reason_view}" rerender="cc-modal-template" status="ajaxstatus" />
<apex:actionFunction name="modal_back" action="{!modal_go_back}" rerender="cc-modal-template" status="ajaxstatus" />
<apex:actionFunction name="cancel_apt" action="{!cancel_scheduled_apt}" rerender="main_holder" status="ajaxstatus" />
<apex:actionFunction name="reschedule_reason" action="{!reschedule_reason_view}" rerender="cc-modal-template" status="ajaxstatus" />
<apex:actionFunction name="reschedule_search" action="{!reschedule_search_view}" rerender="cc-modal-template" status="ajaxstatus" />
<apex:actionFunction name="search_apts" rerender="cc-modal-template,prsched_modal_holder" status="ajaxstatus" />
<apex:actionFunction name="search_all_apts1" action="{!search_all_apt_options}" rerender="apt_search_top_holder1" status="ajaxstatus" />
<apex:actionFunction name="search_all_apts2" action="{!search_all_apt_options}" rerender="apt_search_top_holder2" status="ajaxstatus" />


<apex:actionFunction name="quick_mresched" action="{!quick_sd_resched}" rerender="main_holder" status="ajaxstatus" >
  <apex:param name="mrid" value="" />  
</apex:actionFunction>
<apex:actionFunction name="quick_reason_mresched" action="{!quick_manual_resched}" rerender="main_holder" status="ajaxstatus" >
  <apex:param name="mrid" value="" />  
</apex:actionFunction>
<apex:actionFunction name="reschedule_apt" action="{!reschedule_patient_apt}" rerender="calendar_nav,main_holder" status="ajaxstatus" >
  <apex:param name="blockid" value="" />
  <apex:param name="stime" value="" />
  <apex:param name="doctorid" value="" />
</apex:actionFunction>
<apex:actionFunction name="open_manual_modal" action="{!open_msearch_modal}" rerender="main_holder" status="ajaxstatus" >
  <apex:param name="rid" value="" />
  <apex:param name="ctime" value="" />
</apex:actionFunction>
<apex:actionFunction name="close_msmodal" action="{!close_msearch_modal}" rerender="main_holder" status="ajaxstatus" />
<apex:actionFunction name="doctor_change" action="{!switch_doctor}" rerender="msearch_modal_holder" status="ajaxstatus">
  <apex:param name="docid" value="" />
</apex:actionFunction>
<apex:actionFunction name="msched_time" action="{!manually_schedule_by_time}" rerender="main_holder,clipboard_out" status="ajaxstatus" />
<apex:actionFunction name="msched_doctor" action="{!manually_schedule_by_doctor}" rerender="main_holder,clipboard_out" status="ajaxstatus">
  <apex:param name="docid" value="" />
</apex:actionFunction>
<apex:actionFunction name="msched_suggestion" action="{!manuall_schedule_by_suggestion}" rerender="main_holder,clipboard_out" status="ajaxstatus">
  <apex:param name="sgtime" value="" />
</apex:actionFunction>
<apex:actionFunction name="update_msearch_modal" action="{!calculate_doctor_results}" rerender="msearch_modal_holder" status="ajaxstatus" />

<apex:actionFunction name="save_status_update" action="{!update_resched_status}" rerender="prsched_modal_holder" status="ajaxstatus" />
<apex:actionFunction name="cancel_pending_resched" action="{!cancel_pending_reschedule_apt}" rerender="calendar_nav,prsched_modal_holder" status="ajaxstatus" />

<apex:actionFunction name="open_prmodal" action="{!open_pending_resched_modal}" rerender="main_holder" status="ajaxstatus" />
<apex:actionFunction name="close_prmodal" action="{!close_pending_resched_modal}" rerender="main_holder" status="ajaxstatus" />
<apex:actionFunction name="open_dbmodal" action="{!open_doctor_block_modal}" rerender="main_holder" status="ajaxstatus" />
<apex:actionFunction name="close_dbmodal" action="{!close_doctor_block_modal}" rerender="main_holder" status="ajaxstatus" />
<apex:actionFunction name="open_rbmodal" action="{!open_room_block_modal}" rerender="main_holder" status="ajaxstatus" />
<apex:actionFunction name="close_rbmodal" action="{!close_room_block_modal}" rerender="main_holder" status="ajaxstatus" />
<apex:actionFunction name="view_doc_cblocks" action="{!view_doctor_current_blocks}" rerender="dblock_modal_holder" status="ajaxstatus">
  <apex:param name="docid" value="" />
</apex:actionFunction>
<apex:actionFunction name="view_new_dblock" action="{!view_doctor_new_block}" rerender="dblock_modal_holder" status="ajaxstatus" oncomplete="resize_textarea();">
  <apex:param name="docid" value="" />
</apex:actionFunction>
<apex:actionFunction name="view_rblocks" action="{!view_room_blocks}" rerender="rblock_modal_holder" status="ajaxstatus" oncomplete="resize_textarea();">
  <apex:param name="rid" value="" />
</apex:actionFunction>
<apex:actionFunction name="view_new_rblock_form" action="{!new_room_block_form}" rerender="rblock_modal_holder" status="ajaxstatus" oncomplete="resize_textarea();"/>

<apex:actionFunction name="open_con_modal" action="{!open_conflicts_modal}" rerender="dblock_modal_holder,rblock_modal_holder" status="ajaxstatus" />
<apex:actionFunction name="close_con_modal" action="{!close_conflicts_modal}" rerender="dblock_modal_holder,rblock_modal_holder" status="ajaxstatus" /> 
<apex:actionFunction name="refresh_doctor_block_modal" rerender="dblock_modal_holder" status="ajaxstatus" />
<apex:actionFunction name="refresh_room_block_modal" rerender="rblock_modal_holder" status="ajaxstatus" />
<apex:actionFunction name="save_dblock" action="{!save_doctor_block}" rerender="calendar_nav,dblock_modal_holder" status="ajaxstatus" />
<apex:actionFunction name="save_rblock" action="{!save_room_block}" rerender="calendar_nav,rblock_modal_holder" status="ajaxstatus" />
<apex:actionFunction name="remove_dblock" action="{!remove_doctor_block}" rerender="calendar_nav,dblock_modal_holder" status="ajaxstatus">
  <apex:param name="trid" value="" />
</apex:actionFunction>
<apex:actionFunction name="remove_rblock" action="{!remove_room_block}" rerender="calendar_nav,rblock_modal_holder" status="ajaxstatus">
  <apex:param name="trid" value="" />
</apex:actionFunction>
<apex:actionFunction name="edit_dblock" action="{!edit_doctor_block}" rerender="dblock_modal_holder,rblock_modal_holder" status="ajaxstatus" oncomplete="resize_textarea();">
  <apex:param name="trid" value="" />
</apex:actionFunction>
<apex:actionFunction name="confirm_pending_cancel" action="{!open_resched_cancel_confirmation}" rerender="prsched_modal_holder" status="ajaxstatus">
  <apex:param name="prid" value="" />
</apex:actionFunction>
<apex:actionFunction name="pending_resched_search" action="{!pending_reschedule_search_view}" rerender="prsched_modal_holder" status="ajaxstatus">
  <apex:param name="prid" value="" />
</apex:actionFunction>

<apex:actionFunction name="open_notemodal" action="{!open_note_modal}" rerender="main_holder" status="ajaxstatus" />
<apex:actionFunction name="close_notemodal" action="{!close_note_modal}" rerender="main_holder" status="ajaxstatus" />
<apex:actionFunction name="save_cnote" action="{!save_calendar_note}" rerender="main_holder" status="ajaxstatus" />
<apex:actionFunction name="reset_cnote" action="{!reset_calendar_note}" rerender="dow_header" status="ajaxstatus" />
<apex:actionFunction name="edit_cnote" action="{!edit_calendar_note}" rerender="dow_header" status="ajaxstatus">
  <apex:param name="cnid" value="" />
</apex:actionFunction>

<!-- new calendar navigation methods -->
<apex:actionFunction name="p_calendar_day" action="{!prev_calendar_day}" rerender="main_holder,calendar_nav" status="ajaxstatus" />
<apex:actionFunction name="n_calendar_day" action="{!next_calendar_day}" rerender="main_holder,calendar_nav" status="ajaxstatus" />
<apex:actionFunction name="calendar_drop" action="{!display_calendar_navigation}" rerender="calendar_nav_holder" status="ajaxstatus" />
<apex:actionFunction name="close_nav_calendar" action="{!close_calendar_navigation}" rerender="calendar_nav_holder" status="ajaxstatus" />

<apex:actionFunction name="n_calendar_month" action="{!next_calendar_month}" rerender="modal_cal_holder,calendar_nav" status="ajaxstatus" />
<apex:actionFunction name="p_calendar_month" action="{!prev_calendar_month}" rerender="modal_cal_holder,calendar_nav" status="ajaxstatus" />
<apex:actionFunction name="change_cdate" action="{!select_calendar_day}" rerender="main_holder,calendar_nav" status="ajaxstatus" >
  <apex:param name="cyear" value="" />
  <apex:param name="cmonth" value="" />
  <apex:param name="cday" value="" />
</apex:actionFunction>
<apex:actionFunction name="to_today" action="{!calendar_select_today}" rerender="main_holder,calendar_nav" status="ajaxstatus" />

<apex:actionFunction name="modal_cal_month_view" action="{!display_calendar_month_navigation}" rerender="modal_cal_holder" status="ajaxstatus" />
<apex:actionFunction name="modal_nav_change_month" action="{!select_calendar_month}" rerender="modal_cal_holder" status="ajaxstatus" >
  <apex:param name="mnum" value="" />
</apex:actionFunction>

<apex:actionFunction name="modal_cal_year_view" action="{!display_calendar_year_navigation}" rerender="modal_cal_holder" status="ajaxstatus" />
<apex:actionFunction name="modal_nav_change_year" action="{!select_calendar_year}" rerender="modal_cal_holder" status="ajaxstatus" >
  <apex:param name="myear" value="" />
</apex:actionFunction>

<apex:actionFunction oncomplete="default_cursor(this);" action="{!close_confirmation_modal}" name="close_confirm_pop" rerender="modal_holder,main_holder" status="ajaxstatus" />

<c:HopeRx_print_header CenterRecord="{!current_center}"  />

<apex:outputpanel layout="block" styleclass="cc-nav-wrapper no-print" >
  <apex:outputpanel styleclass="cc-nav-container">
    <apex:outputpanel styleclass="cc-top-nav-container" id="nav_content" layout="block">
      <div class="cc-top-nav-left">
        <apex:outputpanel id="back_holder" styleclass="cc-back-container" layout="block" >
          <apex:outputpanel ><a href="javascript:window.history.go(-1);" class="nav_color">&lt; Back</a></apex:outputpanel>
        </apex:outputpanel> 
        <span class="spacer">&nbsp;</span>
        <div class="cc-link-dropdown-container">
          <span class="dropdown drop-hover">
          <a class="dropdown-toggle nav_color " data-toggle="dropdown"><apex:outputtext value="Recent Patients"  style="padding-right:5px;" styleClass="c-pointer"  /><span class="caret"></span></a>
            <ul class="dropdown-menu overflow-menu" >
              <apex:repeat var="rpatient" value="{!recent_records}">
                <li class="dropdown-lineitem">
                  <a href="javascript:nav_to_recent('{!rpatient.id}');" style="color:#189BEB"><apex:outputtext value="{!rpatient.name}" /></a>
                </li>
              </apex:repeat>
            </ul>
          </span>
        </div> 
        <span style="padding-left:20px;">
          <apex:image id="WULogo" value="{!URLFOR($Resource.WeatherIcons, 'WUndergroundLogo.png')}" style="width:90px;" />
        </span>         
      </div>
      <div class="cc-top-nav-center">
        <div class="cc-link-dropdown-container">
          <span class="dropdown drop-hover">
          <a class="dropdown-toggle nav_color " data-toggle="dropdown"><apex:outputtext value="{!current_center.name}"  style="padding-right:5px;" styleClass="c-pointer"  /><span class="caret"></span></a>
            <ul class="dropdown-menu overflow-menu" >
              <apex:repeat var="center" value="{!center_list}">
                <li class="dropdown-lineitem">
                  <a href="javascript:center_switch('{!center.id}');" style="color:#189BEB"><apex:outputtext value="{!center.name}" /></a>
                </li>
              </apex:repeat>
            </ul>
          </span>
        </div>
      </div>
      <div class="cc-top-nav-right">
        <span class="dropdown drop-hover">
          <a class="dropdown-toggle nav_color" data-toggle="dropdown"><apex:image url="{!URLFOR($Resource.Dental_Practice_Resources,'Images/gear_blue.png')}" width="25" height="25" styleClass="c-pointer"
            onmouseover="this.src='{!URLFOR($Resource.Dental_Practice_Resources,'Images/gear_black.png')}';"
            onmouseout="this.src='{!URLFOR($Resource.Dental_Practice_Resources,'Images/gear_blue.png')}';"
            onclick="this.src='{!URLFOR($Resource.Dental_Practice_Resources,'Images/gear_blue.png')}';"
             /></a>
          <ul class="dropdown-menu gear-menu dropdown-menu-right">
            <apex:repeat var="gitem" value="{!gear_menu}" >
                <li class="dropdown-lineitem" style="display:inline-block;">
                  <a href="{!gitem.Page_URL__c}" style="color:#189BEB;" target="{!gitem.hyperlink_target__c}"  
                      onmouseover="this.firstChild.src='{!URLFOR($Resource.Dental_Practice_Resources,gitem.Image_Name_Hover__c)}';this.style.color='black';" 
                      onmouseout="this.firstChild.src='{!URLFOR($Resource.Dental_Practice_Resources,gitem.Image_Name__c)}';this.style.color='#189BEB';">
                    <apex:image url="{!URLFOR($Resource.Dental_Practice_Resources,gitem.Image_Name__c)}" width="{!if(gitem.name=='Salesforce','30','20')}" height="20" style="display:inline;{!if(gitem.name=='Salesforce','position:relative;left:-7px;margin-right:-6px;','margin-right:5px;')}" />&nbsp;&nbsp;{!gitem.name}
                  </a>
                </li>
            </apex:repeat>
          </ul>        
          </span>
      </div>
    </apex:outputpanel>
    <div class="cc-sub-nav-container" >
      <apex:repeat var="mitem" value="{!clinical_header_items}">
        <apex:outputpanel layout="block" styleclass="cc-sub-nav-cell {!if(mitem.name=='Calendar','cc-color-topNav-selected','')}" onclick="nav_to('{!mitem.id}')">
          <button class="cc-sub-nav-top-button cc-color-{!mitem.css_class__c} cc-hover-tooltips-dark-anchor-nav">
            <i class="{!if(mitem.image_name__c=='home','hrxicon','ccf')}-{!mitem.image_name__c} cc-color-font-white"></i>
            <div>{!mitem.name}</div>          
          </button>
          <div class="cc-button-text">
            {!mitem.name}
          </div>
          <apex:outputpanel rendered="{!if(mitem.name=='Notifications',true,false)}" layout="block"  styleclass="cc-calBadge-badge" style="right:60%;">{!dosespot_notification_count}</apex:outputpanel>
          <div class="cc-button_bg cc-color-{!mitem.css_class__c}">
            <!-- <apex:outputpanel rendered="{!if(mitem.name=='Notifications',true,false)}" layout="block"  styleclass="cc-calBadge-badge">{!dosespot_notification_count}</apex:outputpanel>-->
          </div>
        </apex:outputpanel>
      </apex:repeat>
    </div>
   
    <apex:outputPanel styleclass="cc-clinical-calendar-nav" layout="block" id="calendar_nav">
      <apex:outputPanel layout="block" styleclass="cc-section-link-black cc-font-light-space">
        <apex:selectList value="{!room_type}" styleClass="cc-clinical-calendar-select" multiselect="false" size="1" onchange="cdate_change();" >
          <apex:selectOptions value="{!room_type_list}" />
        </apex:selectList> 
      </apex:outputPanel>
      <apex:outputpanel styleclass="cc-section-link-black cc-font-light-space" layout="block">
        <apex:outputpanel rendered="{!if(calendar_view=='Day',true,false)}">Day</apex:outputpanel>
        <apex:outputpanel rendered="{!if(calendar_view=='Day',false,true)}">
          <apex:commandLink action="{!change_calendar_view}" reRender="calendar_nav,main_holder" value="Day">
            <apex:param name="cview" value="Day" />
          </apex:commandLink>
        </apex:outputpanel>
      </apex:outputpanel>
      <apex:outputpanel layout="block" styleclass="cc-section-link-black cc-font-light-space">
        <apex:outputpanel rendered="{!if(calendar_view=='Week',true,false)}">Week</apex:outputpanel>
        <apex:outputpanel rendered="{!if(calendar_view=='Week',false,true)}">
          <apex:commandLink action="{!change_calendar_view}" reRender="calendar_nav,main_holder" value="Week">
            <apex:param name="cview" value="Week" />
          </apex:commandLink>
        </apex:outputpanel>
      </apex:outputpanel>           
<!--  Andy preferred the date down below
     <div style="display:flex;flex-grow:2;justify-content:center;font-weight:400;font-size:14pt;">
        Tuesday
      </div> -->      
      <apex:outputpanel styleclass="cc_cc_cal_options-container" layout="block">
      
        <div class="cc-toolbar-button-icon-container">          
          <div class="cc-toolbar-button-icon" onclick="to_today();">
            <i class=" hrxicon-today " style="font-size:16pt"></i>            
          </div>
          <div class="cc-toolbar-button-icon-tooltip">
            <div>View Today</div>
          </div>
        </div>
        
        <div class="cc-toolbar-button-icon-container">
          <a href="ccare_calendar_print_test1?pdisplay=1&cdate={!date_parse_out}&ctrid={!current_center.id}" style="text-decoration:none;" target="__blank">          
            <span class="cc-toolbar-button-icon">
                <i class=" ccf-print " style="font-size:16pt"></i>
            </span>          
            <span class="cc-toolbar-button-icon-tooltip">
              <span>Print Calendar</span>
            </span>
          </a>
        </div>
      
        <div class="cc-toolbar-button-icon-container">          
          <div class="cc-toolbar-button-icon" onclick="open_notemodal();">
            <i class=" ccf-flag " style="font-size:16pt"></i>
          </div>
          <div class="cc-toolbar-button-icon-tooltip">
            <div>Add Calendar Note</div>
          </div>
        </div>
      
        <div class="cc-toolbar-button-icon-container">
          <apex:outputpanel layout="block" styleclass="cc-toolbar-button-icon-badge" rendered="{!if(pending_resched_count>0,true,false)}" >
            <div class="cc-toolbar-button-icon-badge-val">{!pending_resched_count}</div>
          </apex:outputpanel>
          <div class="cc-toolbar-button-icon" onclick="open_prmodal();"><i class=" ccf-redo-dash " style="font-size:16pt"></i></div>
          <div class="cc-toolbar-button-icon-tooltip">
            <div>Reschedule list</div>
          </div>
        </div>
      
        <div class="cc-toolbar-button-icon-container" >
          <apex:outputpanel layout="block" styleclass="cc-toolbar-button-icon-badge" rendered="{!if(room_block_count>0,true,false)}">
            <div class="cc-toolbar-button-icon-badge-val">{!room_block_count}</div>
          </apex:outputpanel>
          <div class="cc-toolbar-button-icon" onclick="open_rbmodal();"><i class="ccf-door" style="font-size:16pt"></i></div>
          <div class="cc-toolbar-button-icon-tooltip">
            <div>Block room time</div>
          </div>
        </div>
        <div class="cc-toolbar-button-icon-container" >
          <apex:outputpanel layout="block" styleclass="cc-toolbar-button-icon-badge" rendered="{!if(doctor_block_count>0,true,false)}">
            <div class="cc-toolbar-button-icon-badge-val">{!doctor_block_count}</div>
          </apex:outputpanel>
          <div class="cc-toolbar-button-icon" onclick="open_dbmodal();"><i class="ccf-md" style="font-size:16pt"></i></div>
          <div class="cc-toolbar-button-icon-tooltip">
            <div>Block doctor time</div>
          </div>
        </div>
        
        <apex:outputpanel layout="block" styleclass="cc-toolbar-button-icon-container">
          <apex:outputpanel layout="block" styleclass="cc-toolbar-button-icon cc-color-font-{!total_lab_css}">
            <i class=" ccf-lab " style="font-size:16pt"></i>            
          </apex:outputpanel>
          <apex:outputpanel layout="block" styleclass="cc-toolbar-button-icon-tooltip" >
            <apex:outputpanel >{!total_lab_time}</apex:outputpanel>
          </apex:outputpanel>
        </apex:outputpanel>
        
        
        <!--to-do:figure out if we actually want to use this at some point,  and what that looks like-->
<!--        <apex:outputpanel layout="block" styleclass="cc-toolbar-button-icon-container">
          <apex:outputpanel layout="block" styleclass="cc-toolbar-button-icon" id="cc-calendar-print-button">
            <i class=" ccf-print" style="font-size:16pt"></i>
          </apex:outputpanel>
          <apex:outputpanel layout="block" styleclass="cc-toolbar-button-icon-tooltip" >
            <apex:outputpanel >Print all calendars</apex:outputpanel>
          </apex:outputpanel>
        </apex:outputpanel>-->
        <!--to-do:set up functionality for default view-->
        <apex:outputpanel layout="block" styleclass="cc-toolbar-button-icon-container">
          <apex:outputpanel layout="block" styleclass="cc-toolbar-button-icon" id="cc-calendar-defaultView-button" onclick="set_default_view();">
            <i class="ccf-setting" style="font-size:16pt"></i>
          </apex:outputpanel>
          <apex:outputpanel layout="block" styleclass="cc-toolbar-button-icon-tooltip" >
            <apex:outputpanel layout="block">Set view as default</apex:outputpanel>
          </apex:outputpanel>
        </apex:outputpanel>
      </apex:outputpanel>
    </apex:outputpanel> <!--end cc-clinical-calendar-nav-->
  </apex:outputpanel>
</apex:outputpanel>


<apex:outputpanel styleclass="cc-content-wrapper" layout="block"  id="main_holder" style="width: 100%;padding-left: 50px;overflow: auto;">
  <apex:outputpanel styleclass="cc-content-container" layout="block"> 
  <apex:outputpanel id="error_holder" ><apex:messages style="color:red;font-style:italics;padding-top:3px;" /></apex:outputpanel>
  <apex:actionStatus id="ajaxstatus">
    <apex:facet name="start">
      <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.75; z-index: 10110; background-color: #f2f2f2;">
        &nbsp;
      </div>
      <div style="position: fixed; left: 0; top: 0; bottom: 0; right: 0; z-index: 10111; margin: 20% 50%">
        <!--<apex:image url="{!URLFOR($Resource.Dental_Practice_Resources,'Images/5Wits.gif')}"/>-->
        <!--<img src="http://upload.wikimedia.org/wikipedia/commons/e/ed/Cursor_Windows_Vista.gif" />-->
        <img src="{!URLFOR($Resource.Dental_Practice_Resources,'Images/Circle-out.gif')}" />
        <!--<img src="{!URLFOR($Resource.Dental_Practice_Resources,'Images/5Wits.gif')}" />-->
      </div>
    </apex:facet>
  </apex:actionStatus> 
    <!--To-do: Handle notification stuff-->   
    <!--<apex:outputpanel layout="block" styleclass="cc-cc-notificationContainer no-print">
          <div class="cc-cc-notificationContent-hide" id="cc-cc-errorContent-id">
            <div class="cc-cc-notificationHeader">
              Error message goes here
            </div>
            <div>
              - please <a href="notifications.html" class="">check notifications</a> for more info <a class="cc-cc-notificationContent-link-close" targetdiv="cc-cc-errorContent-id">close</a>
            </div>
          </div>
          <div class="cc-cc-notificationContent-hide" id="cc-cc-warningContent-id">
            <div class="cc-cc-notificationHeader">
              Warning message goes here
            </div>
            <div>
              - please <a href="notifications.html" class="">check notifications</a> for more info <a class="cc-cc-notificationContent-link-close" targetdiv="cc-cc-warningContent-id">close</a>
            </div>
          </div>
          <div class="cc-cc-notificationContent-hide" id="cc-cc-goodStatusContent-id">
            <div class="cc-cc-notificationHeader">
              Good status message goes here
            </div>
            <div>
              - please <a href="notifications.html" class="">check notifications</a> for more info <a class="cc-cc-notificationContent-link-close" targetdiv="cc-cc-goodStatusContent-id">close</a>
            </div>
          </div>
    </apex:outputpanel>--><!--end notification holder-->
    <apex:outputpanel layout="block" styleclass="cc-cc-notificationContainer no-print">
      <apex:outputpanel layout="block" styleclass="cc-cc-notificationContent" rendered="{!manual_search}">
        <div class="cc-cc-notificationHeader" style="color:#b13968;font-weight:bold;padding-top:10px;">
          Manual Scheduling Apt - {!manual_apt.clinical_appointment__r.name} for {!manual_apt.patient_pot__r.account__r.name}
          <apex:commandlink action="{!cancel_manual_schedule}" rerender="main_holder" style="padding-left:30px;color:gray;">cancel</apex:commandlink>      
        </div>
      </apex:outputpanel>      
    </apex:outputpanel>    
    
    <apex:outputpanel id="calendar_holder">
    <apex:outputpanel layout="block" styleclass="cc-cc-notificationContent" style="display:flex;flex-direction:row;align-items:center;" rendered="{!if(calendar_view=='Day',true,false)}" id="dow_header">
      <div style="display:flex;font-size:18pt;font-weight:400;width:300px;padding-left:10px;">
        {!selected_day_of_week} &nbsp; 
        <apex:outputpanel layout="block" rendered="{!if(current_weather!='',true,false)}" styleclass="weather_tooltip"> 
          <apex:image value="{!URLFOR($Resource.WeatherIcons, current_weather.Icon__c + '.gif')}" style="height:30px;width:30px;margin-left:10px;" />
           &nbsp;
          <apex:outputText value="{0,number,##0}" style="color:red;margin-left:5px;"><apex:param value="{!current_weather.Temp_High__c}" /></apex:outputtext>&deg;<apex:outputText value="{0,number,##0}" style="color:blue;margin-left:5px;"><apex:param value="{!current_weather.Temp_Low__c}" /></apex:outputtext>&deg;
          <!-- <apex:outputpanel layout="block" styleclass="weather_tiptext" style="opacity: 1; z-index: 5100;','')} ">                                        
             <div style="text-align:center;width:100%;">
               <div style="padding-bottom:5px;">
                 <apex:outputText value="{0,number,##0}" style="color:red;margin-left:5px;"><apex:param value="{!current_weather.Temp_High__c}" /></apex:outputtext>&deg; 
                 &nbsp;&#124;&nbsp; 
                 <apex:outputText value="{0,number,##0}" style="color:blue;margin-left:5px;"><apex:param value="{!current_weather.Temp_Low__c}" /></apex:outputtext>&deg;
               </div>
               <div style="padding-bottom:5px;">
                 <apex:image value="{!URLFOR($Resource.WeatherIcons, current_weather.Icon__c + '.gif')}" /><br />
                 <span style="font-size:9pt;font-weight:bold;">{!current_weather.conditions__c}</span>
               </div> 
               <apex:outputpanel layout="block" rendered="{!if(current_weather.snow_allday__c>0,true,false)}">Snow : {!current_weather.snow_allday__c} in <span style="font-size:9pt;">({!current_weather.pop__c}%)</span></apex:outputpanel>
               <apex:outputpanel layout="block" rendered="{!if(current_weather.qpf_allday__c>0,true,false)}">Rain : {!current_weather.QPF_allday__c} in <span style="font-size:9pt;">({!current_weather.pop__c}%)</span></apex:outputpanel>
             </div>
          </apex:outputpanel>      --> 
        </apex:outputPanel>
        
      </div>
      <div class="cc-cc-notificationHeader" style="color:#b13968;font-weight:bold;padding-top:10px;flex-direction:column; align-items:flex-start;"> 
        <apex:repeat var="cnote" value="{!calendar_notes}" >
          <!-- are we editing this note -->
          <apex:outputpanel layout="block" style="display:flex;" rendered="{!if(cnote.id==current_edit_id,true,false)}">
            <apex:inputfield value="{!cal_note.Calendar_Note__c}" style="min-width:50%;color:black;" /><span class="spacer">&nbsp;</span>            
            <apex:outputpanel layout="block" styleclass="cc-patient-schedule-row-date cc-clinical-appointment-date-completed cc-hover-tooltips-light">
              <apex:commandLink action="{!save_calendar_note}" reRender="dow_header" value="Save" styleclass="lblue" status="ajaxstatus"/>
            </apex:outputpanel>
            <apex:outputpanel layout="block" styleclass="cc-patient-schedule-row-date cc-clinical-appointment-date-scheduled cc-hover-tooltips-light ">
              <apex:commandLink action="{!close_note_modal}" reRender="dow_header" value="Cancel" styleclass="lblue" status="ajaxstatus" />                   
            </apex:outputpanel>
            <apex:outputpanel layout="block" styleclass="cc-patient-schedule-row-date cc-clinical-appointment-date-completed cc-hover-tooltips-light">
              <apex:commandLink action="{!reset_calendar_note}" reRender="dow_header" value="Reset" styleclass="lblue" status="ajaxstatus"/>
            </apex:outputpanel>
            <apex:outputpanel layout="block" styleclass="cc-patient-schedule-row-date cc-clinical-appointment-date-completed cc-hover-tooltips-light">
              <apex:commandLink action="{!delete_calendar_note}" reRender="dow_header" value="Delete" styleclass="lblue" style="color:red;" status="ajaxstatus"/>
            </apex:outputpanel>
          </apex:outputpanel>          
          <!-- else display the note -->
          <apex:outputpanel layout="block" style="display:flex;" rendered="{!if(cnote.id!=current_edit_id,true,false)}">
            <apex:outputpanel onclick="edit_cnote('{!cnote.id}');">{!cnote.Calendar_Note__c}</apex:outputpanel> 
          </apex:outputpanel>          
        </apex:repeat>           
      </div>
    </apex:outputpanel>  
    <!-- weekly calendar view header -->
    <apex:outputpanel layout="block" styleclass="cc-cc-notificationContent" style="display:flex;flex-direction:row;align-items:center;" rendered="{!if(calendar_view=='Week',true,false)}" id="week_header">
      <div style="display:flex;font-size:18pt;font-weight:400;width:300px;padding-left:10px;">
        {!selected_week_label} &nbsp;              
      </div>      
    </apex:outputpanel>  
    
    <apex:outputpanel layout="block" styleclass="cc-clinical-calendar-schedule-container" style="margin-top:5px;" rendered="{!if(calendar_view=='Day',true,false)}">
      <apex:repeat var="col" value="{!day_calendar_info}">
        <apex:outputpanel layout="block" styleclass="cc-clinical-calendar-schedule-cell" style="{!if(col.header_name=='Time Label','',column_override_css)}" >
          <apex:outputpanel layout="block" styleclass="cc-clinical-calendar-schedule-cell-header">
<!--            <apex:inputField value="{!date_holder.Apt_Date__c}" type="date" styleClass="cc-cc-datepicker" rendered="{!if(col.header_name=='Time Label',true,false)}" />-->
            <!-- <apex:input type="date" value="{!current_date}" styleClass="cc-cc-datepicker" rendered="{!if(col.header_name=='Time Label',true,false)}" onchange="cdate_change();"/> -->
            <apex:outputpanel layout="block" id="calendar_nav_holder" styleClass="cc-cc-datepicker no-print"  rendered="{!if(col.header_name=='Time Label',true,false)}">
             <div style="display:flex;align-items: center;padding-left: 2px;padding-right: 2px; height:100%;">
              <div style="flex-grow:1;">
                <apex:outputtext value="{0,date,M/dd/yyyy}" ><apex:param value="{!current_date}" /></apex:outputtext>
              </div>
              <div onclick="to_today();">
                <i class="hrxicon-today " style="font-size:14px; padding-right:5px;"></i>
              </div>
              <div onclick="p_calendar_day();">
                <i class="ccf-left-arrow" style="font-size: 14px; padding-right: 5px;" ></i>
              </div>
              <div onclick="n_calendar_day();">
                <i class="ccf-right-arrow" style="font-size: 14px; padding-right: 5px;" ></i>
              </div>
              <div onclick="calendar_drop();">
                <i class="ccf-calendar" style="font-size: 14px; padding-right: 5px;" ></i>
              </div>
             </div>
             <apex:outputpanel layout="block" id="modal_cal_holder" rendered="{!display_calendar_view}" styleclass="modal_cal_container">
               <div class="calendar_name">
                 <div class="month_name" >
                   <div class="mcal_nav_box" style="margin-right:5px;" onclick="p_calendar_month();" >
                     <i class="ccf-left-arrow"  ></i>
                   </div>                   
                   <span onclick="modal_cal_month_view();" >{!cmonth.monthname}</span>
                   <div class="mcal_nav_box" style="margin-left:5px;"  onclick="n_calendar_month();" >
                     <i class="ccf-right-arrow"  ></i>
                   </div>
                 </div>            
                 <div class="year_name" onclick="modal_cal_year_view();">{!cmonth.yearnum}</div>                 
                 <div class="mcal_nav_box" style="margin-left:5px;">
                   <i class="ccf-cancel" onclick="close_nav_calendar();" ></i>
                 </div>
               </div>
               <apex:outputPanel layout="block" styleclass="cal_table_holder" rendered="{!if(modal_calendar_view=='calendar','true','false')}">
                 <table class="calendar">
                   <tr class="cheader">
                     <td>Sun</td>
                     <td>Mon</td>
                     <td>Tue</td>
                     <td>Wed</td>
                     <td>Thu</td>
                     <td>Fri</td>
                     <td>Sat</td>
                   </tr>
                   <apex:repeat value="{!cmonth.weeks}" var="week">
                     <tr>
                       <apex:repeat value="{!week.days}" var="day">
                         <td class="{!day.css_style}" style="color:{!day.lab_color}" onclick="{!if(day.display_date,'change_cdate(' + text(cmonth.YearNum) + ',' + text(cmonth.MonthNum) + ',' + text(day.date_num) + ');','return false;')}"><apex:outputText rendered="{!day.display_date}" escape="false;" value="{!day.date_num}" /></td>
                       </apex:repeat>
                     </tr>
                   </apex:repeat>
                 </table>
               </apex:outputPanel>
               <apex:outputPanel layout="block" styleclass="cal_table_holder" rendered="{!if(modal_calendar_view=='month','true','false')}">
                 <table class="calendar"  style="font-size:10pt;">
                   <apex:variable var="mnum" value="1" />
                   <apex:repeat value="{!month_list}" var="mrow">
                     <tr class="mname">
                       <apex:repeat value="{!mrow}" var="mname"> 
                         <td class="{!if(mname==cmonth.ShortMonthName,'selected','unselected')}"><span onclick="modal_nav_change_month({!mnum});">{!mname}</span></td>
                         <apex:variable var="mnum" value="{!(value(mnum)+1)}" />
                       </apex:repeat>
                    </tr>
                  </apex:repeat>
                </table>
               </apex:outputPanel>
               <apex:outputPanel layout="block" styleclass="cal_table_holder" rendered="{!if(modal_calendar_view=='year','true','false')}">
                 <table class="calendar" style="font-size:10pt;">
                   <apex:repeat value="{!year_list}" var="yrow">
                     <tr class="year">
                       <apex:repeat value="{!yrow}" var="yvalue">
                         <td class="{!if(yvalue==cmonth.yearnum,'selected','unselected')}"><span onclick="modal_nav_change_year({!yvalue});">{!yvalue}</span></td>
                       </apex:repeat>
                     </tr>
                   </apex:repeat>
                 </table>                 
               </apex:outputPanel>
             </apex:outputpanel>
              <!--   <apex:input type="date" value="{!current_date}" styleClass="cc-cc-datepicker" rendered="{!if(col.header_name=='Time Label',true,false)}" onchange="cdate_change();"/>-->
           </apex:outputpanel>
            <apex:outputText value="{!col.header_name}" rendered="{!if(col.header_name=='Time Label',false,true)}" />
          </apex:outputpanel>
          <apex:outputpanel layout="block" styleclass="cc-clinical-calendar-schedule-date-draw-container">
            <apex:repeat var="cell" value="{!col.all_cells}">
            <!-- onclick="{!if(manual_search,'override_manual_modal(\'cell.apt.id\',cell.current_time);','')}" -->
              <apex:outputpanel layout="block" styleclass="{!cell.cell_css} {!if(col.header_name=='Time Label',' pad-right','')} {!if(cell.display_picture,' cc-clinical-calendar-schedule-cell-time-container-first', '')}" style="{!cell.top_css}" >
                <apex:outputpanel styleclass="{!if(col.header_name=='Time Label','','cc-cc-calendar-cell-content')}" layout="block" onclick="{!cell.onclick_event}" onmouseover="{!cell.onmouseover_event}" onmouseout="{!cell.onmouseout_event}" style="width:100%;{!cell.cell_style}">              
                  <apex:outputpanel rendered="{!cell.image_display}"><i class="{!cell.image_name}"></i>&nbsp;</apex:outputpanel>                  
                  <apex:outputtext value="{!cell.cell_text}" escape="false" />&nbsp;
                                   
                  <!--hover tooltip for block-->
                  <apex:outputpanel layout="block" rendered="{!if(cell.display_photo_tooltip && cell.display_picture,true,false)}" styleclass="cc-cc-apptInfoHover cc-cc-apptInfoHover-content" style="opacity: 1; z-index: 5100; min-height:200px; {!if(cell.display_picture,'background-image: url(' + URLFOR($Action.Attachment.Download, cell.apt.account__r.Main_Photo_ID__c) + ');background-size: 100% 100%;background-repeat: no-repeat;','')} ">                                        
                    &nbsp;
                  </apex:outputpanel> 
                  <!--end hover tooltip for block-->                                                  
                  
                  <apex:outputtext value="{!cell.confirmation_html}" escape="false" />
                  
                </apex:outputpanel>
                <apex:outputpanel layout="block" styleclass="cc-cal-minuteIndicator-container" style="top: 2px;" rendered="{!cell.current_time}">
                 <div class="cc-cal-minuteIndicator-line cc-bgColor-brightPurple" style="z-index:-1;"></div>
                  <div class="cc-cal-minuteIndicator-triangle" style="z-index:2;">
                   <i class="cc-cal-minuteIndicator cc-color-font-brightPurple ccf-right-arrow" style="z-index:2;" ></i>
                  </div>
                </apex:outputpanel>
              </apex:outputpanel>
            </apex:repeat>
          </apex:outputpanel>
        </apex:outputpanel>
      </apex:repeat>
    </apex:outputPanel> <!--end calendar schedule container - Week view-->
    <apex:outputpanel layout="block" styleclass="cc-clinical-calendar-schedule-container" style="margin-top:5px;"  rendered="{!if(calendar_view=='Week',true,false)}">
      <apex:repeat var="col" value="{!weekly_calendar_info}">
        <apex:outputpanel layout="block" styleclass="cc-clinical-calendar-schedule-cell" style="{!if(col.header_name=='Time Label','',column_override_css)}">
          <apex:outputpanel layout="block" styleclass="cc-clinical-calendar-schedule-cell-header  weather_tooltip" style="font-size: 1.0vw;">
<!--            <apex:inputField value="{!date_holder.Apt_Date__c}" type="date" styleClass="cc-cc-datepicker" rendered="{!if(col.header_name=='Time Label',true,false)}" />-->
            <!-- <apex:input type="date" value="{!current_date}" styleClass="cc-cc-datepicker" rendered="{!if(col.header_name=='Time Label',true,false)}" onchange="body_refresh();" /> -->
            <apex:outputpanel layout="block" id="calendar_nav_holder" styleClass="cc-cc-datepicker"  rendered="{!if(col.header_name=='Time Label',true,false)}">
             <div style="display:flex;align-items: center;padding-left: 2px;padding-right: 2px; height:100%;">
              <div style="flex-grow:1;">
                <apex:outputtext value="{0,date,M/dd/yyyy}" ><apex:param value="{!current_date}" /></apex:outputtext>
              </div>
              <div onclick="p_calendar_day();">
                <i class="ccf-left-arrow" style="font-size: 14px;  padding-right: 5px;" ></i>
              </div>
              <div onclick="n_calendar_day();">
                <i class="ccf-right-arrow" style="font-size: 14px;  padding-right: 5px;" ></i>
              </div>
              <div onclick="calendar_drop();">
                <i class="ccf-calendar" style="font-size: 14px;  padding-right: 5px;" ></i>
              </div>
             </div>
             <apex:outputpanel layout="block" id="modal_cal_holder" rendered="{!display_calendar_view}" styleclass="modal_cal_container">
               <div class="calendar_name">
                 <div class="month_name" >
                   <div class="mcal_nav_box" style="margin-right:5px;">
                     <i class="ccf-left-arrow" onclick="p_calendar_month();" ></i>
                   </div>                   
                   <span onclick="modal_cal_month_view();" >{!cmonth.monthname}</span>
                   <div class="mcal_nav_box" style="margin-left:5px;">
                     <i class="ccf-right-arrow" onclick="n_calendar_month();" ></i>
                   </div>
                 </div>            
                 <div class="year_name" onclick="modal_cal_year_view();">{!cmonth.yearnum}</div>                 
                 <div class="mcal_nav_box" style="margin-left:5px;">
                   <i class="ccf-cancel" onclick="close_nav_calendar();" ></i>
                 </div>
               </div>
               <apex:outputPanel layout="block" styleclass="cal_table_holder" rendered="{!if(modal_calendar_view=='calendar','true','false')}">
                 <table class="calendar">
                   <tr class="cheader">
                     <td>Sun</td>
                     <td>Mon</td>
                     <td>Tue</td>
                     <td>Wed</td>
                     <td>Thu</td>
                     <td>Fri</td>
                     <td>Sat</td>
                   </tr>
                   <apex:repeat value="{!cmonth.weeks}" var="week">
                     <tr>
                       <apex:repeat value="{!week.days}" var="day">
                         <td class="{!day.css_style}" onclick="{!if(day.display_date,'change_cdate(' + text(cmonth.YearNum) + ',' + text(cmonth.MonthNum) + ',' + text(day.date_num) + ');','return false;')}"><apex:outputText rendered="{!day.display_date}" escape="false;" value="{!day.date_num}" /></td>
                       </apex:repeat>
                     </tr>
                   </apex:repeat>
                 </table>
               </apex:outputPanel>
               <apex:outputPanel layout="block" styleclass="cal_table_holder" rendered="{!if(modal_calendar_view=='month','true','false')}">
                 <table class="calendar"  style="font-size:10pt;">
                   <apex:variable var="mnum" value="1" />
                   <apex:repeat value="{!month_list}" var="mrow">
                     <tr class="mname">
                       <apex:repeat value="{!mrow}" var="mname"> 
                         <td class="{!if(mname==cmonth.ShortMonthName,'selected','unselected')}"><span onclick="modal_nav_change_month({!mnum});">{!mname}</span></td>
                         <apex:variable var="mnum" value="{!(value(mnum)+1)}" />
                       </apex:repeat>
                    </tr>
                  </apex:repeat>
                </table>
               </apex:outputPanel>
               <apex:outputPanel layout="block" styleclass="cal_table_holder" rendered="{!if(modal_calendar_view=='year','true','false')}">
                 <table class="calendar" style="font-size:10pt;">
                   <apex:repeat value="{!year_list}" var="yrow">
                     <tr class="year">
                       <apex:repeat value="{!yrow}" var="yvalue">
                         <td class="{!if(yvalue==cmonth.yearnum,'selected','unselected')}"><span onclick="modal_nav_change_year({!yvalue});">{!yvalue}</span></td>
                       </apex:repeat>
                     </tr>
                   </apex:repeat>
                 </table>                 
               </apex:outputPanel>
             </apex:outputpanel>
              <!--   <apex:input type="date" value="{!current_date}" styleClass="cc-cc-datepicker" rendered="{!if(col.header_name=='Time Label',true,false)}" onchange="cdate_change();"/>-->
           </apex:outputpanel>
            <apex:outputText value="{!col.header_name}" rendered="{!if(col.header_name=='Time Label',false,true)}" />
            <apex:outputpanel layout="block" rendered="{!if(col.day_weather!='',true,false)}" styleclass=""> 
              <apex:image value="{!URLFOR($Resource.WeatherIcons, current_weather.Icon__c + '.gif')}" style="height:30px;width:30px;margin-left:10px;" /> &nbsp;
              <!-- <apex:outputText value="{0,number,##0}" style="margin-left:5px;"><apex:param value="{!col.day_weather.Temp_High__c}" /></apex:outputtext>&deg;
              <apex:outputText value="{0,number,##0}" style="margin-left:5px;"><apex:param value="{!col.day_weather.Temp_Low__c}" /></apex:outputtext>&deg; -->
              <apex:outputpanel layout="block" styleclass="weather_tiptext" style="opacity: 1; z-index: 5100; color:black;">                                        
                 <div style="text-align:center;width:100%;">
                   <div style="padding-bottom:5px;">
                     <apex:outputText value="{0,number,##0}" style="color:red;margin-left:5px;"><apex:param value="{!col.day_weather.Temp_High__c}" /></apex:outputtext>&deg; 
                     &nbsp;&#124;&nbsp; 
                     <apex:outputText value="{0,number,##0}" style="color:blue;margin-left:5px;"><apex:param value="{!col.day_weather.Temp_Low__c}" /></apex:outputtext>&deg;
                   </div>
                   <div style="padding-bottom:5px;">
                     <apex:image value="{!URLFOR($Resource.WeatherIcons, current_weather.Icon__c + '.gif')}" /><br />
                     <span style="font-size:9pt;font-weight:bold;">{!col.day_weather.conditions__c}</span>
                   </div> 
                   <apex:outputpanel layout="block" rendered="{!if(col.day_weather.Snow_AllDay__c>0,true,false)}">Snow : {!col.day_weather.Snow_AllDay__c} in <span style="font-size:9pt;">({!col.day_weather.POP__c}%)</span></apex:outputpanel>
                   <apex:outputpanel layout="block" rendered="{!if(col.day_weather.QPF_Allday__c>0,true,false)}">Rain : {!col.day_weather.QPF_Allday__c} in <span style="font-size:9pt;">({!col.day_weather.POP__c}%)</span></apex:outputpanel>
                 </div>
              </apex:outputpanel>      
            </apex:outputPanel>
            
          </apex:outputpanel>
          <apex:outputpanel layout="block" styleclass="cc-clinical-calendar-schedule-date-draw-container">
            <apex:repeat var="cell" value="{!col.all_cells}">
              <apex:outputpanel layout="block" styleclass="cc-clinical-calendar-schedule-cell-time-container {!if(col.header_name=='Time Label',' pad-right','')}">
                {!cell.cell_text}&nbsp;
                <!--work through all of our sub cells-->
                <apex:repeat var="scell" value="{!cell.sub_cells}">
                  <apex:outputpanel layout="block" styleclass="{!scell.container_css}">
                    <apex:outputpanel layout="block" styleclass="{!scell.cell_css}">
                      {!scell.cell_text}
                    </apex:outputpanel>
                  </apex:outputpanel>
                </apex:repeat> <!--done working through sub cells-->
                <apex:outputpanel layout="block" styleclass="cc-cal-minuteIndicator-container" style="top: 2px;" rendered="{!cell.current_time}">
                 <div class="cc-cal-minuteIndicator-line cc-bgColor-brightPurple" style="z-index:2;"></div>
                  <div class="cc-cal-minuteIndicator-triangle" style="z-index:2;">
                   <i class="cc-cal-minuteIndicator cc-color-font-brightPurple ccf-right-arrow" style="z-index:2;" ></i>
                  </div>
                </apex:outputpanel>
              </apex:outputpanel>
            </apex:repeat><!--done working thorugh time cells-->
          </apex:outputpanel>
        </apex:outputpanel>
      </apex:repeat><!--done working through columns-->
    </apex:outputPanel> <!--end calendar schedule container - WEEK view-->
    </apex:outputpanel>
    
    <!-- Start manual block -->
    <apex:outputpanel layout="block" rendered="{!manual_search}">
    <div id="cc-schedule-block-container" onclick="standard_manual_modal();">
      <div id="cc-schedule-block-name " class="cc-block-row">
        <i class="ccf-patient"></i> <span>{!manual_apt.patient_pot__r.account__r.name}</span>
      </div>
      <div id="cc-schedule-block-appt " class="cc-block-row">
        <i class="ccf-tooth"></i> <span>{!manual_apt.clinical_appointment__r.name}</span>
      </div>
      <apex:repeat var="brow" value="{!manual_block_size}">
        <div class="cc-block-row"> &nbsp; </div> 
      </apex:repeat>
    </div>
    </apex:outputpanel> 
    
    
    
    <!--Start Calendar modal--->
    <apex:outputpanel layout="block" rendered="{!display_calendar_modal}" id="calendar_modal_holder" >
    <apex:outputpanel layout="block" styleclass="cc-modal-wrapper" id="cc-modal-template" style="z-index: 10001; opacity: 1;">
    <apex:outputpanel layout="block" styleclass="cc-modal-container" style="box-shadow: rgba(0, 0, 0, 0.74902) 0px 0px 70px -15px;">
      <apex:outputpanel layout="block" styleclass="cc-modal-close">
        <div id="cc-modal-close-button" onclick="close_cmodal();">
          <i class="ccf-cancel-thin cc-color-font-black cc-cursor-hover"></i>
        </div>
      </apex:outputpanel>
      <apex:outputpanel layout="block" styleclass="cc-modal-warning ">
        <apex:messages styleclass="cc-modal-warning-message cc-color-font-red cc-font-bold " />
        <!--<apex:outputpanel layout="block" styleclass="cc-modal-warning-icon cc-color-font-red cc-font-bold">
          <i class="ccf-warning"></i>
        </apex:outputpanel>
        <apex:outputpanel layout="block" styleclass="cc-modal-warning-message cc-color-font-red cc-font-bold ">
          Patient needs a medical clearance
        </apex:outputpanel>-->
      </apex:outputpanel>
      <apex:outputpanel layout="block" styleclass="cc-modal-content-container">
        <!-- start modal nav menu template -->
        <div id="cc-modal-navMenu-template-container" style="width:100%;">
          <div id="cc-modal-navMenu-id" class="cc-modal-navMenu-container">
            <apex:outputpanel layout="block" styleclass="cc-modal-navMenu-list"> <!--START Left Menu Links-->
              <apex:repeat var="mitem" value="{!clinical_header_items}">
                <apex:outputpanel layout="block" styleclass="cc-cc-modal-nav-row-link" onclick="nav_to('{!mitem.id}')">
                  <apex:outputpanel layout="block" styleclass="cc-modal-navMenu-icons cc-color-{!mitem.css_class__c}">
                    <i class="{!if(mitem.image_name__c=='home','hrxicon','ccf')}-{!mitem.image_name__c} cc-color-font-white"></i>
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-cc-apptInfoRow-appointmentLabel cc-cc-apptInfoHoverId-{!mitem.name}">
                    {!mitem.name}
                  </apex:outputpanel>
                </apex:outputpanel>
              </apex:repeat>                             
            </apex:outputpanel> <!--END Left Menu Links-->
            <apex:outputpanel layout="block" styleclass="cc-modal-navMenu-border">
            </apex:outputpanel>
            <apex:outputpanel layout="block" styleclass="cc-modal-navMenu-content-container">
              <!-- start modal right side content -->
              <apex:outputpanel layout="block" styleclass="cc-modal-rightSide-content">
                <apex:outputpanel layout="block" styleclass="cc-modal-navMenu-content-header">

                </apex:outputpanel>
                <apex:outputpanel layout="block" rendered="{!if(calendar_modal_display=='block_info',true,false)}">
                <apex:outputpanel layout="block" styleclass="cc-modal-navMenu-content">
                  <apex:outputpanel layout="block" styleclass="cc-modal-patientInfo-container">
                    <apex:outputpanel layout="block" styleclass="cc-modal-patientInfo-row">
                      <apex:outputpanel layout="block" styleclass="cc-modal-patientInfo-name">
                        {!apt_block.account__r.name} - {!apt_block.patient_pot_apt__r.patient_pot__r.name} &nbsp;<apex:outputpanel style="color:#0a66e0;">{!current_status}</apex:outputpanel>
                      </apex:outputpanel>
                      <apex:outputpanel layout="block" styleclass="cc-modal-patientInfo-confirmation">
                        <apex:inputfield value="{!apt_block.Confirmation_Status__c}" onchange="update_cstatus();"/>
                      </apex:outputpanel>
                    </apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-modal-patientInfo-row">
                      <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-patient">
                        <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">
                          {!apt_block.patient_pot_apt__r.name}
                        </apex:outputpanel>
                        <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">
                          {!block_formatted_date}
                        </apex:outputpanel>
                        <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">
                          {!block_apt_time}
                        </apex:outputpanel>
                      </apex:outputpanel>
                    </apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-modal-phone-container">                      
                      <apex:outputpanel layout="block" styleclass="cc-modal-phone-cell">
                        <apex:outputpanel layout="block" styleclass="cc-modal-phone-checkbox">
                          <label>
                            Room:
                            <apex:outputpanel layout="block" styleclass="cc-modal-patientInfo-content">
                              {!apt_block.clinical_room__r.name}
                            </apex:outputpanel>
                          </label>
                        </apex:outputpanel>
                      </apex:outputpanel>                      
                      <apex:outputpanel layout="block" styleclass="cc-modal-phone-cell">
                        <apex:outputpanel layout="block" styleclass="cc-modal-phone-checkbox" >
                          <label>
                            Doctor:
                            <apex:outputpanel layout="block" rendered="{!if(allow_doctor_adjustment,false,true)}" styleclass="cc-modal-patientInfo-content">
                              {!apt_block.doctor__r.name} 
                            </apex:outputpanel>
                            <apex:outputpanel layout="block" rendered="{!allow_doctor_adjustment}" styleclass="cc-modal-patientInfo-content">
                              <apex:selectList value="{!apt_block.Doctor__c}" onchange="update_cstatus();" size="1">
                                <apex:selectOptions value="{!all_doctor_list}" />
                              </apex:selectList>
                            </apex:outputpanel>
                          </label>
                        </apex:outputpanel>
                      </apex:outputpanel>
                    </apex:outputpanel>                    
                    <apex:outputpanel layout="block" styleclass="cc-modal-phone-container">                      
                      <apex:outputpanel layout="block" styleclass="cc-modal-phone-cell">
                        <apex:outputpanel layout="block" styleclass="cc-modal-phone-checkbox">
                          <label>
                            Mobile:
                            <apex:outputpanel layout="block" styleclass="cc-modal-patientInfo-content">
                              {!apt_block.account__r.personmobilephone}
                            </apex:outputpanel>
                          </label>
                        </apex:outputpanel>
                      </apex:outputpanel>
                      <apex:outputpanel layout="block" styleclass="cc-modal-phone-cell">
                        <apex:outputpanel layout="block" styleclass="cc-modal-phone-checkbox">
                          <label>
                            Home:
                            <apex:outputpanel layout="block" styleclass="cc-modal-patientInfo-content">
                              {!apt_block.account__r.phone}
                            </apex:outputpanel>
                          </label>
                        </apex:outputpanel>
                      </apex:outputpanel>
                      <apex:outputpanel layout="block" styleclass="cc-modal-phone-cell">
                        <apex:outputpanel layout="block" styleclass="cc-modal-phone-checkbox" >
                          <label>
                            Email:
                            <apex:outputpanel layout="block" styleclass="cc-modal-patientInfo-content">
                              {!apt_block.account__r.Email__c}
                            </apex:outputpanel>
                          </label>
                        </apex:outputpanel>
                      </apex:outputpanel>
                    </apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-modal-phone-container">                      
                      <apex:outputpanel layout="block" styleclass="cc-modal-phone-cell">
                        <apex:outputpanel layout="block" styleclass="cc-modal-phone-checkbox">
                          <label>
                            Health History :
                            <apex:outputpanel layout="block" styleclass="cc-modal-patientInfo-content">
                              {!block_health_history_status}
                            </apex:outputpanel>
                          </label>
                        </apex:outputpanel>
                      </apex:outputpanel>                                            
                    </apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-modal-distance-row">
                      <apex:outputpanel layout="block" styleclass="">Distance from center:</apex:outputpanel>
                      <apex:outputpanel layout="block" styleclass="cc-modal-patientInfo-content">{!apt_block.account__r.Distance_To_Center__c}</apex:outputpanel>
                    </apex:outputpanel>
                    <apex:outputtext escape="false" value="{!apt_timestamps}" />                    
                  </apex:outputpanel>
                </apex:outputpanel>
                <!-- start status content -->
                <apex:outputpanel layout="block" styleclass="cc-calendar-patientStatus-list">
                  <div style="font-weight:bold;">Status:</div>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-patientStatus{!if(allow_arrived,'-option','-disabled')}" onclick="{!if(allow_arrived,"mark_arrived('" + apt_block.id + "');",'return false;')}" >
                    Arrived
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-patientStatus{!if(allow_ready,'-option','-disabled')}" onclick="{!if(allow_ready,"mark_ready('" + apt_block.id + "');",'return false;')}" >
                    Ready
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-patientStatus{!if(allow_started,'-option','-disabled')}" onclick="{!if(allow_started,"mark_started('" + apt_block.id + "');",'return false;')}" >
                    Started
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-patientStatus{!if(allow_completed,'-option','-disabled')}" onclick="{!if(allow_completed,"mark_completed('" + apt_block.id + "');",'return false;')}" >
                    Completed
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-patientStatus{!if(allow_no_show,'-option','-disabled')}" onclick="{!if(allow_no_show,"mark_no_show('" + apt_block.id + "');",'return false;')}" >
                    No Show
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-patientStatus{!if(allow_patient_left,'-option','-disabled')}" onclick="{!if(allow_patient_left,"mark_left('" + apt_block.id + "');",'return false;')}" >
                    Patient Left
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-patientStatus{!if(allow_incomplete,'-option','-disabled')}" onclick="{!if(allow_incomplete,"incomplete_reason('" + apt_block.id + "');",'return false;')}" >
                    Incomplete
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-patientStatus{!if(allow_reset,'-reset','-disabled')}" onclick="{!if(allow_reset,"mark_reset('" + apt_block.id + "');",'return false;')}" >
                    Reset
                  </apex:outputpanel>
                </apex:outputpanel>
                <!-- end status content -->
                <!-- start action -->
                <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-container" rendered="{!allow_apt_change}" >
                  <apex:outputpanel layout="block"  styleclass="cc-calendar-scheduling-action-cancel cc-calendar-scheduling-action-button" onclick="cancel_reason();">
                    Cancel appointment
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-reschedule cc-calendar-scheduling-action-button" onclick="reschedule_reason();">
                    Reschedule appointment
                  </apex:outputpanel>
                  <apex:outputpanel layout="block"  styleclass="cc-calendar-scheduling-action-extend cc-calendar-scheduling-action-button" rendered="{!allow_apt_extension}" onclick="extend_block('{!apt_block.id}');">
                    +10 Minutes
                  </apex:outputpanel>
                  <apex:outputpanel layout="block"  styleclass="cc-calendar-scheduling-action-reduce cc-calendar-scheduling-action-button" rendered="{!allow_apt_reduction}" onclick="reduce_block('{!apt_block.id}');">
                    -10 Minutes
                  </apex:outputpanel>
                  <apex:outputpanel layout="block"  styleclass="cc-calendar-scheduling-action-sroom cc-calendar-scheduling-action-button" onclick="switch_room_v('{!apt_block.id}');">
                    Change Room
                  </apex:outputpanel>
                  <apex:outputpanel layout="block"  styleclass="cc-calendar-scheduling-action-sdoc cc-calendar-scheduling-action-button" onclick="switch_doc_v('{!apt_block.id}');">
                    Change Doctor
                  </apex:outputpanel>
                  <apex:outputpanel rendered="{!allow_sd_resched_option}" layout="block" styleclass="cc-calendar-scheduling-action-mresched cc-calendar-scheduling-action-button" onclick="quick_mresched('{!apt_block.id}');">
                    M Resched
                  </apex:outputpanel>
                  <apex:outputpanel rendered="{!allow_sd_Apt_Change}" layout="block" styleclass="cc-calendar-scheduling-action-achange cc-calendar-scheduling-action-button" onclick="show_apt_change_form();">
                    Change Apt
                  </apex:outputpanel>
                </apex:outputpanel>
                <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-container" rendered="{!if(allow_apt_change,false,true)}" >
                  <apex:outputpanel rendered="{!allow_sd_Apt_Change}" layout="block" styleclass="cc-calendar-scheduling-action-achange cc-calendar-scheduling-action-button" onclick="show_apt_change_form();">
                    Change Apt
                  </apex:outputpanel>
                </apex:outputpanel>
                <!-- display calendar note if present -->                
                <apex:outputpanel layout="block" styleclass="cc-calendar-patientStatus-list" rendered="{!if(apt_block.patient_pot_apt__r.Doctor_Notes__c!='',true,false)}" style="paddinf-top:10px;padding-right:20%;align-items: initial;">
                  <span style="font-weight:bold;width:80px;">Note :</span>
                  <span style="font-weight:400;">{!apt_block.patient_pot_apt__r.Doctor_Notes__c}</span> 
                </apex:outputpanel>
                <apex:outputpanel layout="block" id="apt_change_form" rendered="{!display_apt_change}">   
                  <div style="padding-top:1em;padding-bottom:1em;margin-left:40px;display:flex;">                                      
                     <apex:inputText value="{!new_apt_name}" styleclass="input_standard psearch_name" onfocus="if(this.value=='Enter Appointment') {this.value='';}" onkeyup="apt_qsearch_key();"  /><span class="spacer">&nbsp;</span>                                      
                     <apex:selectList value="{!apt_filter}" onchange="apt_change_refresh();" size="1">
                       <apex:selectOptions value="{!apt_category_list}" />
                     </apex:selectList><span class="spacer">&nbsp;</span>
                     <apex:outputpanel layout="block" styleclass="cc-patient-schedule-row-date cc-clinical-appointment-date-completed cc-hover-tooltips-light">
                       <apex:commandLink action="{!add_appointment_step}" reRender="calendar_modal_holder" value="Save" styleclass="lblue" status="ajaxstatus"/>
                     </apex:outputpanel>
                     <apex:outputpanel layout="block" styleclass="cc-patient-schedule-row-date cc-clinical-appointment-date-scheduled cc-hover-tooltips-light ">
                        <apex:commandLink action="{!hide_apt_form}" reRender="calendar_modal_holder" value="Cancel" styleclass="lblue" status="ajaxstatus" />
                     </apex:outputpanel>
                     <apex:outputpanel layout="block" styleclass="cc-clinical-appointment-date-comments">
                       <apex:commandLink action="{!reset_apt_form}" reRender="apt_change_form" value="Reset" styleclass="lblue" status="ajaxstatus" />
                     </apex:outputpanel>                     
                  </div>                                             
                  <div class="procedure_matches">
                    <apex:repeat var="sresult" value="{!search_appointments}" >
                      <span onclick="apt_select('{!sresult.id}');" class="overflow_option"><apex:outputText value="{!sresult.name}" /></span>
                    </apex:repeat>
                  </div>
                </apex:outputpanel>
              </apex:outputpanel>                           
              
              <!--Start Incomplete Reason View-->
              <apex:outputpanel layout="block" rendered="{!if(calendar_modal_display=='incomplete_reason_view',true,false)}" >
                <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-container">
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-backCancel " onclick="modal_back();">
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-backCancel-back-icon"><i class="ccf-left-arrow"></i></apex:outputpanel>
                    Back
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-patient">
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!apt_block.account__r.name}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!apt_block.patient_pot_apt__r.name}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!block_formatted_date}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!block_apt_time}</apex:outputpanel>
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-button-container">
                    <apex:outputpanel layout="block" styleclass="cc-modal-cancellation-reason-container ">
                      <apex:selectList value="{!cancel_reason}" size="1" onchange="refresh_incomplete_button();">
                        <apex:selectOptions value="{!incomplete_reason_list}" />
                      </apex:selectList>
                    </apex:outputpanel>
                    <apex:outputpanel layout="block" id="incomplete_button_holder"><apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-confirmCancel{!if(cancel_reason=='NA','-disabled','')} cc-calendar-scheduling-action-button" onclick="{!if(cancel_reason<>'NA',"mark_incomplete('" + apt_block.id + "');",'return false;')}" >Confirm Incomplete</apex:outputpanel></apex:outputpanel>
                  </apex:outputpanel>
                </apex:outputpanel>
              </apex:outputpanel><!--End Incomplete Reason View-->
              
              <!--Switch Room View-->
              <apex:outputpanel layout="block" rendered="{!if(calendar_modal_display=='switch_room_view',true,false)}" >
                <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-container">
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-backCancel " onclick="modal_back();">
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-backCancel-back-icon"><i class="ccf-left-arrow"></i></apex:outputpanel>
                    Back
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-patient">
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!apt_block.account__r.name}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!apt_block.patient_pot_apt__r.name}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!block_formatted_date}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!block_apt_time}</apex:outputpanel>
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-results">
                    <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-results-row-container"  style="opacity:1;">  
                      <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-row">
                        <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-header">
                          <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-date-container">Rooms</apex:outputpanel>                                        
                        </apex:outputpanel>
                      </apex:outputpanel>
                        
                        <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-content">
                          <!--repeat through all doctors here-->
                          <apex:repeat var="sroom" value="{!possible_switch_rooms}">
                            <div style="display:flex;flex-direction:column;width:100%;">
                              <div style="display:flex;flex-direction:row;flex-wrap:nowrap;width:100%;line-height:25px;font-size:12pt;align-items:center;justify-content:flex-start;">
                                <div style="width:200px;padding-right:5px;">{!sroom.room.name}</div>
                                <div style="min-width:150px;">
                                  <apex:outputpanel rendered="{!if(sroom.total_conflicts > 0,true,false)}">
                                    <apex:commandlink action="{!view_room_switch_conflict_detail}" rerender="msearch_modal_holder" status="ajaxstatus" style="color:#b13968;">
                                      {!sroom.total_conflicts} Conflict(s)
                                      <apex:param name="roomid" value="{!sroom.room.id}" />
                                    </apex:commandlink>
                                  </apex:outputpanel>
                                  <apex:outputpanel rendered="{!if(sroom.total_conflicts>0,false,true)}">Available</apex:outputpanel>
                                </div>
                                <apex:outputpanel layout="block" rendered="{!if(sroom.total_conflicts==0,true,false)}">
                                  <div class="cc-modal-appointmentList-label cc-blockTime-sched-button" style="background-color: rgb(25, 117, 210);" onclick="confirm_room_switch('{!apt_block.id}','{!sroom.room.id}');">Schedule</div>
                                </apex:outputpanel>
                              </div>
                            </div>
                          </apex:repeat>
                          <!--end block repeat-->
                        </apex:outputpanel>                      
                      </apex:outputpanel>                      
                    </apex:outputpanel>    
                </apex:outputpanel>
              </apex:outputpanel><!--End switch room view-->
              
              <!--Switch Doctor View-->
              <apex:outputpanel layout="block" rendered="{!if(calendar_modal_display=='switch_doctor_view',true,false)}" >
                <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-container">
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-backCancel " onclick="modal_back();">
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-backCancel-back-icon"><i class="ccf-left-arrow"></i></apex:outputpanel>
                    Back
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-patient">
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!apt_block.account__r.name}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!apt_block.patient_pot_apt__r.name}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!block_formatted_date}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!block_apt_time}</apex:outputpanel>
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-results">
                    <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-results-row-container"  style="opacity:1;">  
                      <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-row">
                        <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-header">
                          <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-date-container">Doctors</apex:outputpanel>                                        
                        </apex:outputpanel>
                      </apex:outputpanel>
                        
                        <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-content">
                          <!--repeat through all doctors here-->
                          <apex:repeat var="sdoc" value="{!doc_results}">                            
                            <apex:outputpanel style="display:flex;flex-direction:column;width:100%;" rendered="{!if(sdoc.doctor.id==apt_block.Doctor__c,false,true)}">
                              <div style="display:flex;flex-direction:row;flex-wrap:nowrap;width:100%;line-height:40px;font-size:12pt;align-items:center;justify-content:flex-start;">
                                <div style="width:200px;padding-right:5px;">{!sdoc.doctor.name}</div>
                                <div style="min-width:150px;">
                                  <apex:outputpanel rendered="{!sdoc.has_conflicts}">
                                    <apex:commandlink action="{!view_conflict_detail}" rerender="msearch_modal_holder" status="ajaxstatus" style="color:#b13968;">
                                      {!sdoc.num_conflicts} Conflict(s)
                                      <apex:param name="docid" value="{!sdoc.doctor.id}" />
                                    </apex:commandlink>
                                  </apex:outputpanel>
                                  <apex:outputpanel rendered="{!if(sdoc.has_conflicts,false,true)}">
                                    <apex:outputpanel rendered="{!sdoc.has_inventory}">Available</apex:outputpanel>
                                    <apex:outputpanel rendered="{!if(sdoc.has_inventory,false,true)}">Unavailable</apex:outputpanel>
                                  </apex:outputpanel>
                                </div>
                                <apex:outputpanel layout="block" rendered="{!if(sdoc.has_conflicts,false,true)}">                                  
                                  <apex:outputpanel rendered="{!sdoc.has_inventory}" styleclass="cc-modal-appointmentList-label cc-blockTime-sched-button" style="background-color: rgb(25, 117, 210);" onclick="confirm_doctor_switch('{!apt_block.id}','{!sdoc.doctor.id}');">Schedule</apex:outputpanel>
                                </apex:outputpanel>
                              </div>
                            </apex:outputpanel>
                          </apex:repeat>
                          <!--end block repeat-->
                        </apex:outputpanel>                      
                      </apex:outputpanel>                      
                    </apex:outputpanel>    
                </apex:outputpanel>
              </apex:outputpanel>
              <!--End switch doctor view-->
              
              <!--Start Cancel Reason View-->
              <apex:outputpanel layout="block" rendered="{!if(calendar_modal_display=='cancel_reason_view',true,false)}" >
                <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-container">
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-backCancel " onclick="modal_back();">
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-backCancel-back-icon"><i class="ccf-left-arrow"></i></apex:outputpanel>
                    Back
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-patient">
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!apt_block.account__r.name}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!apt_block.patient_pot_apt__r.name}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!block_formatted_date}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!block_apt_time}</apex:outputpanel>
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-button-container">
                    <apex:outputpanel layout="block" styleclass="cc-modal-cancellation-reason-container ">
                      <apex:selectList value="{!cancel_reason}" size="1" onchange="refresh_cancel_button();">
                        <apex:selectOptions value="{!cancel_reason_list}" />
                      </apex:selectList>
                    </apex:outputpanel>
                    <apex:outputpanel layout="block" id="cancel_button_holder"><apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-confirmCancel{!if(cancel_reason=='NA','-disabled','')} cc-calendar-scheduling-action-button" onclick="{!if(cancel_reason=='NA','return false;','cancel_apt();')}" >Confirm cancellation</apex:outputpanel></apex:outputpanel>
                  </apex:outputpanel>
                </apex:outputpanel>
              </apex:outputpanel><!--End cancel Reason View-->
              
              <!--Start Reschedule Reason View-->
              <apex:outputpanel layout="block" rendered="{!if(calendar_modal_display=='reschedule_reason_view',true,false)}" >
                <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-container">
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-backCancel " onclick="modal_back();">
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-backCancel-back-icon"><i class="ccf-left-arrow"></i></apex:outputpanel>
                    Back
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-patient">
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!apt_block.account__r.name}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!apt_block.patient_pot_apt__r.name}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!block_formatted_date}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!block_apt_time}</apex:outputpanel>
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-button-container">
                    <apex:outputpanel layout="block" styleclass="cc-modal-cancellation-reason-container ">
                      <apex:selectList value="{!cancel_reason}" size="1" onchange="refresh_reschedule_button();">
                        <apex:selectOptions value="{!reschedule_reason_list}" />
                      </apex:selectList>
                    </apex:outputpanel>
                    <apex:outputpanel layout="block" id="reschedule_button_holder" style="display:flex;">
                      <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-confirmReschedule{!if(cancel_reason=='NA','-disabled','')} cc-calendar-scheduling-action-button" onclick="{!if(cancel_reason=='NA','return false;','reschedule_search();')}" >Reschedule - Search</apex:outputpanel>
                      <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-confirmReschedule{!if(cancel_reason=='NA','-disabled','')} cc-calendar-scheduling-action-button" onclick="{!if(cancel_reason=='NA','return false;','')}quick_reason_mresched('{!apt_block.id}');" >Reschedule - Manual</apex:outputpanel>                      
                    </apex:outputpanel>
                  </apex:outputpanel>
                </apex:outputpanel>
              </apex:outputpanel><!--End reschedule Reason View-->
              
              <!--Start Reschedule Apt Search View-->
              <apex:outputpanel layout="block" rendered="{!if(calendar_modal_display=='reschedule_search_view',true,false)}"  >
                <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-container">
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-backCancel " onclick="modal_back();">
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-action-backCancel-back-icon"><i class="ccf-left-arrow"></i></apex:outputpanel>
                    Back
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-patient">
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!apt_block.account__r.name}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!apt_block.patient_pot_apt__r.name}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!block_formatted_date}</apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-calendar-scheduling-cancelAppt-label">{!block_apt_time}</apex:outputpanel>
                  </apex:outputpanel>
                  <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences" id="apt_search_top_holder1">
                    <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences-row">
                      <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences-label">Time:</apex:outputpanel>
                      <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_open}"  />&nbsp;8-10AM</label></apex:outputpanel>
                      <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_morning}" />&nbsp; 10-12PM</label></apex:outputpanel>
                      <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_noon}"  />&nbsp; 12-2PM</label></apex:outputpanel>
                      <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_afternoon}" />&nbsp; 2-4PM</label></apex:outputpanel>
                      <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_close}"  />&nbsp; 4-6PM</label></apex:outputpanel>
                    </apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences-row">
                      <apex:outputpanel layout="block">Day:</apex:outputpanel>
                      <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_monday}" /> Monday</label></apex:outputpanel>
                      <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_tuesday}"  /> Tuesday</label></apex:outputpanel>
                      <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_wednesday}" /> Wednesday</label></apex:outputpanel>
                      <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_thursday}" /> Thursday</label></apex:outputpanel>
                      <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_friday}" /> Friday</label></apex:outputpanel>
                    </apex:outputpanel>
                    <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences-row">
                      <apex:outputpanel layout="block">
                        <div>Month:</div>
                        <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences-month-container">              
                          <apex:selectList value="{!month_filter}"  size="1">
                            <apex:selectOptions value="{!month_option_list}" />
                          </apex:selectList>
                        </apex:outputpanel>
                      </apex:outputpanel>
                      <div style="min-width:50px;">&nbsp;</div>
                      <div>
		                <div style="padding-right:5px;">Doctor :</div>
		                  <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences-month-container">              
		                    <apex:selectList value="{!doctor_filter}" size="1">
		                      <apex:selectOptions value="{!doctor_search_list}" />
		                    </apex:selectList>
		                  </apex:outputpanel>
		                </div>
		                <div style="min-width:50px;">&nbsp;</div>
		                <div>
		                  <div class="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" onclick="search_all_apts1();" style="margin:0px;padding:5px;background-color:#337ab7;margin-right:30px;">Search All</div>
		                  <div class="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" onclick="search_apts();" style="margin:0px;padding:5px;background-color: rgb(82, 204, 105);color: white;text-align: center;border-radius: 4px;transition: .25s;">Search</div> 
		                </div>
                    </apex:outputpanel>
                  </apex:outputpanel> <!--end search preferences-->

                  
                  <!--Start search results container-->
                  <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-results" id="apt_search_results_holder">
                    <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-results-row-container"  style="opacity:1;">
                      <div class="sresults_header">
		                <span class="sresults_text">{!search_pager.search_results_header}</span> 
		                <span class="spacer">&nbsp;</span>
		                <apex:outputpanel layout="block" styleclass="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" style="margin:0px;padding:5px;background-color:#337ab7;margin-right:30px;" rendered="{!search_pager.allow_prev}" onclick="prev_page();">Prev</apex:outputpanel>              
		                <apex:outputpanel layout="block" styleclass="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" style="margin:0px;padding:5px;background-color:#337ab7;margin-right:30px;" rendered="{!search_pager.allow_next}" onclick="next_page();">Next</apex:outputpanel> 
		              </div> 
                      <!--repeat through search dates -->     
                      <apex:repeat var="dheader" value="{!apt_search_results}" >
                        <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-row">
                          <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-header">
                            <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-date-container">{!dheader.display_date}</apex:outputpanel>
                            <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-lab-container-old">
                              <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-lab-button-old cc-modal-searchResults-lab-button-{!dheader.current_lab_class}-old">
                                <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-lab-icon-old"><i class="ccf-lab"></i></apex:outputpanel>
                                <apex:outputpanel >{!dheader.current_lab_time_display}</apex:outputpanel>
                              </apex:outputpanel>
                              &nbsp; to &nbsp;
                              <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-lab-button-old cc-modal-searchResults-lab-button-{!dheader.projected_lab_class}-old">
                                <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-lab-icon-old"><i class="ccf-lab"></i></apex:outputpanel>
                                <apex:outputpanel >{!dheader.projected_lab_time}</apex:outputpanel>
                              </apex:outputpanel>                            
                            </apex:outputpanel>            
                          </apex:outputpanel>
                        </apex:outputpanel>
                        <apex:outputpanel styleclass="cc-cc-notificationHeader" style="color:#b13968;font-weight:bold;padding-top:10px;flex-direction:column; align-items:flex-start;" rendered="{!if(dheader.cal_notes.size>0,true,false)}">
                          <apex:repeat var="dhead_note" value="{!dheader.cal_notes}">
                            <div>{!dhead_note.Calendar_Note__c}</div>
                          </apex:repeat>
                        </apex:outputpanel>
                        
                        <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-content">
                          <!--repeat through possible blocks here-->
                          <apex:repeat var="ablock" value="{!dheader.match_list}">
                            <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-button " onclick="reschedule_apt('{!ablock.si.Clinical_Apt_Calendar__c}',{!ablock.stime},'{!ablock.si.clinical_doctor_inventory__r.User__c}');">
                              <apex:outputpanel styleclass="cc-modal-searchResults-button-content">
                                <apex:outputtext value="{!ablock.apt_label}" escape="false" />
                              </apex:outputpanel>
                            </apex:outputpanel>
                          </apex:repeat>
                          <!--end block repeat-->
                        </apex:outputpanel>
                      </apex:repeat>
                      <!--end date repeat-->
                      <div class="sresults_header">
			            <span class="sresults_text">{!search_pager.search_results_header}</span> 
			            <span class="spacer">&nbsp;</span>
			            <apex:outputpanel layout="block" styleclass="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" style="margin:0px;padding:5px;background-color:#337ab7;margin-right:30px;" rendered="{!search_pager.allow_prev}" onclick="prev_page();">Prev</apex:outputpanel>              
			            <apex:outputpanel layout="block" styleclass="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" style="margin:0px;padding:5px;background-color:#337ab7;margin-right:30px;" rendered="{!search_pager.allow_next}" onclick="next_page();">Next</apex:outputpanel> 
			          </div>
                    </apex:outputpanel>                      
                  </apex:outputpanel>      
                  <!-- end schedule search container -->
                </apex:outputpanel>
              </apex:outputpanel>
              <!--End Reschedule Apt Search View-->
              
              
              </apex:outputpanel>
              <!-- end modal right side content -->

            </apex:outputpanel>
          </div>

        </div>
        <!-- start modal nav menu template -->

      </apex:outputpanel>
    </apex:outputpanel>
  </apex:outputpanel>
  </apex:outputpanel><!--End Calendar Modal-->
  
  <!--Start Manual Search modal--->
  <apex:outputpanel layout="block" rendered="{!display_msearch_modal}" id="msearch_modal_holder" >
    <div class="cc-modal-wrapper" id="cc-ms-modal-template" style="z-index: 10001; opacity: 1;" formtype="blankModal">
      <apex:outputpanel layout="block" styleclass="cc-modal-container" style="box-shadow: rgba(0, 0, 0, 0.74902) 0px 0px 70px -15px;">
        <apex:outputpanel layout="block" styleclass="cc-modal-close">
          <div id="cc-modal-close-button" onclick="close_msmodal();">
            <i class="ccf-cancel-thin cc-color-font-black cc-cursor-hover"></i>
          </div>
        </apex:outputpanel>
        <apex:outputpanel layout="block" styleclass="cc-modal-warning ">
          <apex:messages styleclass="cc-modal-warning-message cc-color-font-red cc-font-bold " />        
        </apex:outputpanel>
        <apex:outputpanel layout="block" styleclass="cc-modal-content-container">        
          <div id="" class="" manualschedulecontent="">
            <div id="cc-modal-navMenu-id" class="cc-modal-navMenu-container">
              <div class="cc-modal-navMenu-list">
                <div class=" cc-cc-modal-nav-row-link {!if(msearch_doctor=='Any','cc-modal-leftNav-selected','')}">
                  <div class="cc-cc-apptInfoRow-appointmentLabel cc-cc-apptInfoHoverId-patient " onclick="doctor_change('Any');">Any Doctor</div>
                </div>
                <apex:repeat var="possible_doc" value="{!active_doctor_list}">
                  <div class=" cc-cc-modal-nav-row-link {!if(msearch_doctor==possible_doc.id,'cc-modal-leftNav-selected','')}">
                    <div class="cc-cc-apptInfoRow-appointmentLabel cc-cc-apptInfoHoverId-patient " onclick="doctor_change('{!possible_doc.id}');">{!possible_doc.name}</div>
                  </div>
                </apex:repeat>        
              </div>
              <div class="cc-modal-navMenu-border">   </div>
              <div class="cc-modal-navMenu-content-container">
                <!-- start modal right side content -->
                <div class="cc-modal-rightSide-content">
                  <div class="cc-modal-navMenu-content-header">{!manual_apt.patient_pot__r.account__r.name}</div>
                  <div>{!manual_apt.clinical_appointment__r.name}</div>
                  <!-- start status content -->
                  <div class="cc-modal-appointmentList-container">
                    <!-- start appt -->
                    <div class="cc-modal-time-input-wrapper ">
                      <div class="cc-modal-appointmentList-label-time">Start</div>
                      <div class="cc-modal-time-input-container">                
                        <div class="cc-modal-time-input" >
                          <apex:selectList value="{!msearch_hour}" size="1" style="height:100%;" onchange="update_msearch_modal();">
                            <apex:selectOptions value="{!hour_options}" />
                          </apex:selectList>
                        </div>
                        <div class="cc-modal-time-input" >
                          <apex:selectList value="{!msearch_minute}" size="1" style="height:100%;" onchange="update_msearch_modal();">
                            <apex:selectOptions value="{!minute_options}" />
                          </apex:selectList>
                        </div>
                        <div class="cc-modal-time-input" >
                          <apex:selectList value="{!msearch_suffix}" size="1" style="height:100%;" onchange="update_msearch_modal();">
                            <apex:selectOptions value="{!suffix_options}" />
                          </apex:selectList>
                        </div>
                        <apex:outputpanel styleclass="cc-manualOverride-warning-text" rendered="{!msearch_possible_conflict}" >*Manual scheduling may result in conflicts</apex:outputpanel>
                      </div>
                    </div>
                    <!-- end appt -->
                    <!-- start appt -->
                    <div class="cc-modal-time-input-wrapper">
                      <div class="cc-modal-appointmentList-label-time">End</div>
                      {!msearch_end_time}  
                    </div>
                    <!-- end appt -->
            
                    <!-- start appt -->
                    <div class="cc-blockTime-button-container">
                      <div class="cc-modal-appointmentList-label cc-blockTime-cancel cancel-blockTime" onclick="close_msmodal();">Cancel</div>
                      <apex:outputpanel layout="block" styleclass="cc-modal-appointmentList-label cc-blockTime-cancel save-blockTime" rendered="{!if(msearch_doctor=='Any',false,true)}" onclick="msched_time();">Save</apex:outputpanel>
                    </div>
                    <!-- end appt -->   
                    <!--Start search results container for Any Doctor-->
                    <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-results" rendered="{!if(msearch_doctor=='Any',true,false)}">
                      <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-results-row-container"  style="opacity:1;">  
                        <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-row">
                          <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-header">
                            <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-date-container">Doctors</apex:outputpanel>                                        
                          </apex:outputpanel>
                        </apex:outputpanel>
                        
                        <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-content">
                          <!--repeat through all doctors here-->
                          <apex:repeat var="sdoc" value="{!doc_results}">
                            <div style="display:flex;flex-direction:column;width:100%;">
                              <div style="display:flex;flex-direction:row;flex-wrap:nowrap;width:100%;line-height:25px;font-size:12pt;align-items:center;justify-content:flex-start;">
                                <div style="width:200px;padding-right:5px;">{!sdoc.doctor.name}</div>
                                <div style="min-width:150px;">
                                  <apex:outputpanel rendered="{!sdoc.has_conflicts}">
                                    <apex:commandlink action="{!view_conflict_detail}" rerender="msearch_modal_holder" status="ajaxstatus" style="color:#b13968;">
                                      {!sdoc.num_conflicts} Conflict(s)
                                      <apex:param name="docid" value="{!sdoc.doctor.id}" />
                                    </apex:commandlink>
                                  </apex:outputpanel>
                                  <apex:outputpanel rendered="{!if(sdoc.has_conflicts,false,true)}">Available</apex:outputpanel>
                                </div>
                                <apex:outputpanel layout="block" rendered="{!if(sdoc.blocks.size==0,true,false)}">
                                  <div class="cc-modal-appointmentList-label cc-blockTime-cancel save-blockTime" style="background-color: {!if(sdoc.has_conflicts,'red','rgb(25, 117, 210);')}" onclick="msched_doctor('{!sdoc.doctor.id}');">Schedule</div>
                                </apex:outputpanel>
                              </div>
                            </div>
                          </apex:repeat>
                          <!--end block repeat-->
                        </apex:outputpanel>                      
                      </apex:outputpanel>                      
                    </apex:outputpanel>      
                    <!-- end schedule search container for any doctor -->
                    <!--Start suggested times container for selected Doctor-->
                    <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-results" rendered="{!if(msearch_doctor=='Any',false,true)}">
                      <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-results-row-container"  style="opacity:1;">  
                        <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-row">
                          <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-header">
                            <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-date-container">Suggested Times for {!search_doctor_name}</apex:outputpanel>                                        
                          </apex:outputpanel>
                        </apex:outputpanel>
                        
                        <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-content">
                          <!--repeat through possible blocks here-->
                          <apex:repeat var="ablock" value="{!msearch_suggested_times}">
                            <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-button " onclick="msched_suggestion('{!ablock.int_time}');" style="{!ablock.button_style}">
                              <apex:outputpanel styleclass="cc-modal-searchResults-button-content">
                                <apex:outputtext value="{!ablock.display_time}" escape="false" />
                              </apex:outputpanel>
                            </apex:outputpanel>
                          </apex:repeat>
                          <!--end block repeat-->
                        </apex:outputpanel>                      
                      </apex:outputpanel>                      
                    </apex:outputpanel>      
                    <!-- end suggested times container for selected Doctor -->
                             
                  </div>
                  <!-- end modal right side content -->
                </div>
              </div>
            </div>
            <!-- start modal nav menu template -->
          </div>
        </apex:outputpanel>
        <apex:outputpanel layout="block" styleclass="cc-form-confirmTrash-container" rendered="{!display_confirmation_modal}">
          <div class="cc-form-confirmTrash">
            
            <apex:outputpanel rendered="{!if(modal_type=='report_conflicts',true,false)}">
              <apex:outputtext value="{!modal_out}" escape="false" />
              <div class="cc-form-confirmTrash-buttonContainer">
                <div class="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" onclick="close_confirm_pop();">Close</div> 
              </div>        
            </apex:outputpanel>
            
            <apex:outputpanel rendered="{!if(modal_type=='Sched Issue',true,false)}">
              <apex:outputtext value="{!modal_out}" escape="false" />
              <div class="cc-form-confirmTrash-buttonContainer">
                <div class="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" onclick="close_confirm_pop();">Close</div> 
              </div>        
            </apex:outputpanel>
                        
          </div>
        </apex:outputpanel>
      </apex:outputpanel>
    </div>
  </apex:outputpanel>  <!--End Manual Search Modal-->
  
  <!-- Start Doctor Block Modal -->
  <apex:outputpanel layout="block" rendered="{!display_doctor_block_modal}" id="dblock_modal_holder" >  
    <div class="cc-blankModal-wrapper"  style="top: 3.5%; z-index: 10001; opacity: 1;" formtype="blankModal">
      <div class="cc-modal-container" style="box-shadow: rgba(0, 0, 0, 0.74902) 0px 0px 70px -15px;">
        <apex:outputpanel layout="block" styleclass="cc-modal-close">
          <div id="cc-modal-close-button" onclick="close_dbmodal();">
            <i class="ccf-cancel-thin cc-color-font-black cc-cursor-hover"></i>
          </div>
        </apex:outputpanel>      
        <div class="cc-modal-content-container">
          <div id="" style="width:100%;" blockdrtime="" class="">
            <div id="cc-modal-navMenu-id" class="cc-modal-navMenu-container">
              <div class="cc-modal-navMenu-list">
                <div class="cc-cc-modal-nav-row-link-header">Current blocks</div>
                <div>
                  <apex:outputpanel layout="block" styleclass=" cc-cc-modal-nav-row-link cc-modal-leftNav" rendered="{!if(doctor_block_count==0,true,false)}">None</apex:outputpanel>
                
                  <apex:repeat var="doc" value="{!doctors_with_blocks}">
                    <div class=" cc-cc-modal-nav-row-link {!if(doc.id==current_tab_id && block_view=='Current','cc-modal-leftNav-selected','')}" onclick="view_doc_cblocks('{!doc.id}');">
                      <div class="cc-cc-apptInfoRow-appointmentLabel cc-cc-apptInfoHoverId-patient " >{!doc.name}</div>
                    </div>
                  </apex:repeat>                               
                </div>
                <div class="cc-cc-modal-nav-row-link-header">Set a block</div>                
                <div>         
                  <apex:repeat var="doc" value="{!doctor_tab_list}">
                    <div class=" cc-cc-modal-nav-row-link {!if(doc.id==current_tab_id && block_view=='New','cc-modal-leftNav-selected','')}" onclick="view_new_dblock('{!doc.id}');">
                      <div class="cc-cc-apptInfoRow-appointmentLabel cc-cc-apptInfoHoverId-patient " >{!doc.name}</div>
                    </div>  
                  </apex:repeat>                                   
                </div>
              </div>
              <div class="cc-modal-navMenu-border"> </div>
              <div class="cc-modal-navMenu-content-container">
                <!-- start modal right side content -->
                <div class="cc-modal-rightSide-content">      
                  <apex:messages style="color:red;font-style:italics;padding-top:3px;" />                               
                  <apex:outputpanel layout="block" rendered="{!if(block_view=='Current',true,false)}">
                  <div class="cc-modal-navMenu-content-header">{!current_block_doctor_name} is blocked on the calendar on &nbsp;
                    <apex:outputtext value="{0,date,M/dd/yyyy}" > 
                      <apex:param value="{!current_date}" />
                    </apex:outputtext> from these times:</div>
                  <!-- start status content -->
                  <div class="cc-modal-appointmentList-container">
                    <apex:repeat var="block" value="{!current_doctor_time_blocks}">
                    <!-- start appt -->
                    <div class="cc-modal-time-input-wrapper">
                      <div class="cc-modal-appointmentList-label-time">Start</div>
                      <div class="cc-modal-time-input-container">
                        <apex:outputpanel layout="block" styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,false,true)}">
                          <apex:outputtext value="{!if(block.Start_Hour_Int__c<=12,block.Start_Hour__c,(block.Start_Hour_Int__c-12))}" />:
                          <apex:outputtext value="{!if(len(block.Start_Minute__c)<2,'0' + block.Start_Minute__c,block.Start_Minute__c)}" />&nbsp;
                          <apex:outputtext value="{!if(block.Start_Hour_Int__c<12,'AM','PM')}" />
                        </apex:outputpanel>
                        <apex:outputpanel layout="block" styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,true,false)}">                          
                            <apex:selectList value="{!shour_holder}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                              <apex:selectOptions value="{!hour_options}" />
                            </apex:selectList>
                            <apex:selectList value="{!new_time_block.Start_Minute__c}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                              <apex:selectOptions value="{!minute_options}" />
                            </apex:selectList>
                            <apex:selectList value="{!sprefix}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                              <apex:selectOptions value="{!suffix_options}" />
                            </apex:selectList>                          
                        </apex:outputpanel>                        
                      </div>
                    </div>
                    <!-- end appt -->
                    <!-- start appt -->
                    <div class="cc-modal-time-input-wrapper">
                      <div class="cc-modal-appointmentList-label-time">End</div>
                      <div class="cc-modal-time-input-container">
                        <apex:outputpanel layout="block"  styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,false,true)}">
                          <apex:outputtext value="{!if(block.End_Hour_Int__c<=12,block.End_Hour__c,(block.End_Hour_Int__c-12))}" />:
                          <apex:outputtext value="{!if(len(block.End_Minute__c)<2,'0' + block.End_Minute__c,block.End_Minute__c)}" />&nbsp;
                          <apex:outputtext value="{!if(block.End_Hour_Int__c<12,'AM','PM')}" />
                        </apex:outputpanel>
                        <apex:outputpanel layout="block" styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,true,false)}">                          
                            <apex:selectList value="{!ehour_holder}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                              <apex:selectOptions value="{!hour_options}" />
                            </apex:selectList>
                            <apex:selectList value="{!new_time_block.End_Minute__c}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                              <apex:selectOptions value="{!minute_options}" />
                            </apex:selectList>
                            <apex:selectList value="{!eprefix}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                              <apex:selectOptions value="{!suffix_options}" />
                            </apex:selectList>                          
                        </apex:outputpanel> 
                      </div>
                    </div>
                    <!-- end appt -->
                    <!-- start appt -->
                    <div class="cc-modal-time-input-wrapper">
                      <div class="cc-modal-appointmentList-label-time">Reason</div>
                      <div class="cc-modal-time-input-container">
                        <apex:outputpanel layout="block" styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,false,true)}">
                          <apex:outputtext value="{!block.Block_Reason__c}" />
                        </apex:outputpanel>
                        <apex:outputpanel layout="block" styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,true,false)}">
                          <apex:selectList value="{!new_time_block.Block_Reason__c}" size="1" style="height:100%;width:100%;">
                            <apex:selectOptions value="{!doctor_block_reason_list}" />
                          </apex:selectList>                          
                        </apex:outputpanel>                        
                      </div>
                    </div>
                    <!-- end appt -->
                    <!-- start appt -->
                    <div class="cc-modal-time-input-wrapper" style="width:100%;">
                      <div class="cc-modal-appointmentList-label-time">Note</div>
                      <div class="cc-modal-time-input-container" style="width:100%;">
                        <apex:outputpanel layout="block" styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,false,true)}">
                          <apex:outputtext value="{!block.Block_Note__c}" />
                        </apex:outputpanel>
                        <apex:outputpanel layout="block" styleclass="cc-modal-time-input" style="width:100%;" rendered="{!if(block.id==current_edit_id,true,false)}">
                          <apex:inputfield value="{!neW_time_block.Block_Note__c}" style="width:100%;" />
                        </apex:outputpanel>                        
                      </div>
                    </div>
                    <!-- end appt -->
                    
                    <apex:outputpanel layout="block" styleclass="cc-block-warningMessage" rendered="{!if(block.id==current_edit_id && display_conflicts.size>0,true,false)}">
                      <div onclick="open_con_modal();">There are <span>{!display_conflicts.size} appointments</span> in this time block.</div>
                      <div>These appointments will be added to the pending reschedule queue</div>
                    </apex:outputpanel>

                    <!-- start appt -->
                    <div class="cc-blockTime-button-container">                      
                      <!-- start option -->
                      <apex:outputpanel layout="block" rendered="{!if(block.id==current_edit_id,false,true)}">
                        <a class="cc-modal-appointmentList-label cc-modal-blockTime-button cc-modal-blockTime-button-rescheduleAll" onclick="remove_dblock('{!block.id}');" style="text-decoration:none;"><i class="ccf-x-circle"></i> Remove block</a>
                      </apex:outputpanel>
                      <!-- end option -->
                      <!-- start option -->
                      <apex:outputpanel layout="block" rendered="{!if(block.id==current_edit_id,false,true)}">
                        <a class="cc-modal-appointmentList-label cc-modal-blockTime-button cc-modal-blockTime-button-reassign" style="text-decoration:none;" onclick="edit_dblock('{!block.id}');"><i class="ccf-clock"></i> Edit times</a>                        
                      </apex:outputpanel> 
                      <!-- end option -->
                      <!-- start option -->
                      <apex:outputpanel layout="block" rendered="{!if(block.id==current_edit_id,true,false)}">
                        <a class="cc-modal-appointmentList-label cc-modal-blockTime-button" onclick="save_dblock();"><i class="ccf-save"></i> Save</a>
                      </apex:outputpanel>
                      <!-- end option -->
                    </div>
                    <!-- end appt -->
                    </apex:repeat>
                  </div>
                  <!-- end status content -->
                  </apex:outputpanel>
                  
                  <apex:outputpanel layout="block" rendered="{!if(block_view=='New',true,false)}">
                  <div class="cc-modal-navMenu-content-header">Block off time for {!current_block_doctor_name} on &nbsp;               
                    <apex:outputtext value="{0,date,M/dd/yyyy}" > 
                      <apex:param value="{!current_date}" />
                    </apex:outputtext>
                  </div>
                  <!-- start status content -->
                  <div class="cc-modal-appointmentList-container">
                    <!-- start appt -->
                    <div class="cc-modal-time-input-wrapper">
                      <div class="cc-modal-appointmentList-label-time">Start</div>
                      <div class="cc-modal-time-input-container">
                        <div class="cc-modal-time-input" blocktimestart="hour">
                          <apex:selectList value="{!new_time_block.Start_Hour__c}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                            <apex:selectOptions value="{!hour_options}" />
                          </apex:selectList>
                        </div>
                        <div class="cc-modal-time-input" blocktimestart="minutes">
                          <apex:selectList value="{!new_time_block.Start_Minute__c}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                            <apex:selectOptions value="{!minute_options}" />
                          </apex:selectList>
                        </div>
                        <div class="cc-modal-time-input" blocktimestart="ampm">
                          <apex:selectList value="{!sprefix}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                            <apex:selectOptions value="{!suffix_options}" />
                          </apex:selectList>
                        </div>
                      </div>
                    </div>
                    <!-- end appt -->
                    <!-- start appt -->
                    <div class="cc-modal-time-input-wrapper">
                      <div class="cc-modal-appointmentList-label-time">End</div>
                      <div class="cc-modal-time-input-container">
                        <div class="cc-modal-time-input" blocktimestart="hour">
                          <apex:selectList value="{!new_time_block.End_Hour__c}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                            <apex:selectOptions value="{!hour_options}" />
                          </apex:selectList>
                        </div>
                        <div class="cc-modal-time-input" blocktimestart="minutes">
                          <apex:selectList value="{!new_time_block.End_Minute__c}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                            <apex:selectOptions value="{!minute_options}" />
                          </apex:selectList>
                        </div>
                        <div class="cc-modal-time-input" blocktimestart="ampm">
                          <apex:selectList value="{!eprefix}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                            <apex:selectOptions value="{!suffix_options}" />
                          </apex:selectList>
                        </div>
                      </div>
                    </div>
                    <!-- end appt -->
                    <!-- start appt -->
                    <div class="cc-modal-time-input-wrapper">
                      <div class="cc-modal-appointmentList-label-time">Reason</div>
                      <div class="cc-modal-time-input-container">
                        <div class="cc-modal-time-input" blocktimereason="">
                        <apex:selectList value="{!new_time_block.Block_Reason__c}" size="1" style="height:100%;width:100%;">
                                <apex:selectOptions value="{!doctor_block_reason_list}" />
                              </apex:selectList>
                        </div>
                      </div>
                    </div>
                    <!-- end appt -->
                    <!-- start appt -->
                    <div class="cc-modal-time-input-wrapper" style="width:100%;">
                      <div class="cc-modal-appointmentList-label-time">Note</div>
                      <div class="cc-modal-time-input-container" style="width:100%;">
                        <div class="cc-modal-time-input" blocktimereason="" style="width:100%;">
                          <apex:inputfield value="{!new_time_block.Block_Note__c}"  style="width:100%;"/>
                        </div>
                      </div>
                    </div>
                    <!-- end appt -->
                    
                    <!-- start warning -->
                    <apex:outputpanel layout="block" styleclass="cc-block-warningMessage" rendered="{!if(estimated_appointment_conflicts.size>0,true,false)}">
                      <div onclick="open_con_modal();">There are <span>{!estimated_appointment_conflicts.size} appointments</span> in this time block.</div>
                      <div>These appointments will be added to the pending reschedule queue</div>
                    </apex:outputpanel>
                    <!-- end warning -->
                    <!-- start appt -->
                    <div class="cc-blockTime-button-container">              
                      <!-- start option -->
                      <div class="">
                        <a class="cc-modal-appointmentList-label cc-modal-blockTime-button" onclick="save_dblock();"><i class="ccf-save"></i> Save</a>
                      </div>
                      <!-- end option -->
                      <!-- start option -->
                      <!-- <div class="" modalaction="blockDrTime-reschedule">
                        <a class="cc-modal-appointmentList-label cc-modal-blockTime-button cc-modal-blockTime-button-rescheduleAll">
                          <i class="ccf-redo-dash"></i> Reschedule
                        </a>
                      </div> -->
                      <!-- end option -->
                      <!-- start option -->
                      <!-- <div class="" modalaction="blockDrTime-reassign">
                        <a class="cc-modal-appointmentList-label cc-modal-blockTime-button cc-modal-blockTime-button-reassign">
                          <i class="ccf-md"></i> Reassign
                        </a>                   
                      </div> -->
                      <!-- end option -->
                    </div>
                    <!-- end appt -->
                  </div>
                  </apex:outputpanel>
                  <!-- end modal right side content -->
                </div>
              </div>
            </div>
            <!-- start modal nav menu template -->        
          </div>
        </div>
        <!-- start conflicts modal -->
        <apex:outputpanel layout="block" styleclass="cc-form-confirmReschedule-container" rendered="{!display_conflicts_modal}">
          <div class="cc-form-confirmTrash cc-confirm-wide ">  
            <div>
              <div class="">The following appointments will be added to the pending reschedule list</div>
              <div class="cc-modal-appointmentInfoContainer-wrapper">
                <apex:repeat var="conflict" value="{!display_conflicts}">
                  <div class="cc-modal-appointmentInfoContainer">
                    <div class="cc-modal-appointmentInfo">                    
                      <div>{!conflict.account__r.name}</div>
                      <div>{!conflict.patient_pot_apt__r.name}</div>
                      <div><apex:outputtext value="{0,date,M/dd/yyyy}" > 
                        <apex:param value="{!conflict.Apt_Date__c}" />
                      </apex:outputtext> &nbsp;
                      <apex:outputtext value="{!if(conflict.Start_Hour_Int__c<=12,conflict.Start_Hour__c,(conflict.Start_Hour_Int__c-12))}" />:
                      <apex:outputtext value="{!if(len(conflict.Start_Minute__c)<2,'0' + conflict.Start_Minute__c,conflict.Start_Minute__c)}" />&nbsp;
                      <apex:outputtext value="{!if(conflict.Start_Hour_Int__c<12,'AM','PM')}" /> -&nbsp;
                      <apex:outputtext value="{!if(conflict.End_Hour_Int__c<=12,conflict.End_Hour__c,(conflict.End_Hour_Int__c-12))}" />:
                      <apex:outputtext value="{!if(len(conflict.End_Minute__c)<2,'0' + conflict.End_Minute__c,conflict.End_Minute__c)}" />&nbsp;
                      <apex:outputtext value="{!if(conflict.End_Hour_Int__c<12,'AM','PM')}" />
                      </div>
                    </div>            
                  </div>
                </apex:repeat>                                
              </div>
            </div>      
            <div class="cc-form-confirmTrash-buttonContainer">
              <div class="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" onclick="close_con_modal();">Close</div>
            </div>
          </div>
        </apex:outputpanel>
      </div>
    </div>    
  </apex:outputpanel>
  <!--End Doctor Block Modal-->
  
  <!-- Start Room Block Modal -->
  <apex:outputpanel layout="block" rendered="{!display_room_block_modal}" id="rblock_modal_holder" >  
    <div class="cc-blankModal-wrapper"  style="top: 3.5%; z-index: 10001; opacity: 1;" formtype="blankModal">
      <div class="cc-modal-container" style="box-shadow: rgba(0, 0, 0, 0.74902) 0px 0px 70px -15px;">
        <apex:outputpanel layout="block" styleclass="cc-modal-close">
          <div id="cc-modal-close-button" onclick="close_rbmodal();">
            <i class="ccf-cancel-thin cc-color-font-black cc-cursor-hover"></i>
          </div>
        </apex:outputpanel>      
        <div class="cc-modal-content-container" style="height:100%;">
          <div id="" style="width:100%;height:100%;" blockdrtime="" class="">
            <div id="cc-modal-navMenu-id" class="cc-modal-navMenu-container" style="height:90%;">
              <div class="cc-modal-navMenu-list" style="height:100%;">                            
                <div style="height:100%;overflow-y:auto;">         
                  <apex:repeat var="room" value="{!room_tab_list}">
                    <div class=" cc-cc-modal-nav-row-link {!if(room.id==current_tab_id,'cc-modal-leftNav-selected','')}" onclick="view_rblocks('{!room.id}');">
                      <div class="cc-cc-apptInfoRow-appointmentLabel cc-cc-apptInfoHoverId-patient cc-room-hasBlock " >{!room.name}</div>
                      <apex:outputpanel layout="block" styleclass="cc-blockedRooms-number" rendered="{!if(room.clinical_time_restrictions__r.size>0,true,false)}">
                        {!room.clinical_time_restrictions__r.size}
                      </apex:outputpanel>
                    </div>                      
                  </apex:repeat>                                   
                </div>
              </div>
              <div class="cc-modal-navMenu-border"> </div>
              <div class="cc-modal-navMenu-content-container">
                <!-- start modal right side content -->
                <div class="cc-modal-rightSide-content">      
                  <apex:messages style="color:red;font-style:italics;padding-top:3px;" />    
                  <apex:outputpanel layout="block" rendered="{!if(block_view=='',true,false)}">
                    <i>Please select a room to view or create new blocks</i>
                  </apex:outputpanel>
                                           
                  <apex:outputpanel layout="block" rendered="{!if(block_view=='',false,true)}">
                    <div class="cc-modal-navMenu-content-header">Block off time for {!current_block_room_name} on &nbsp; 
                      <apex:outputtext value="{0,date,M/dd/yyyy}" > 
                        <apex:param value="{!current_date}" />
                      </apex:outputtext>               
                    </div>
                    <apex:outputpanel layout="block" styleclass="cc-modal-addNewBlock cc-addNewBlockContainer-link " rendered="{!if(block_view=='New',false,true)}" onclick="view_new_rblock_form();">+ Add new</apex:outputpanel>
                    
                    <apex:outputpanel layout="block" rendered="{!if(block_view=='New',true,false)}">
                      <!-- start status content -->
                      <div class="cc-modal-appointmentList-container">
                        <!-- start appt -->
                        <div class="cc-modal-time-input-wrapper">
                          <div class="cc-modal-appointmentList-label-time">Start</div>
                          <div class="cc-modal-time-input-container">
                            <div class="cc-modal-time-input" blocktimestart="hour">
                              <apex:selectList value="{!new_time_block.Start_Hour__c}" size="1" style="height:100%;" onchange="refresh_room_block_modal();">
                                <apex:selectOptions value="{!hour_options}" />
                              </apex:selectList>
                            </div>
                            <div class="cc-modal-time-input" blocktimestart="minutes">
                              <apex:selectList value="{!new_time_block.Start_Minute__c}" size="1" style="height:100%;" onchange="refresh_room_block_modal();">
                                <apex:selectOptions value="{!minute_options}" />
                              </apex:selectList>
                            </div>
                            <div class="cc-modal-time-input" blocktimestart="ampm">
                              <apex:selectList value="{!sprefix}" size="1" style="height:100%;" onchange="refresh_room_block_modal();">
                                <apex:selectOptions value="{!suffix_options}" />
                              </apex:selectList>
                            </div>
                          </div>
                        </div>
                        <!-- end appt -->
                        <!-- start appt -->
                        <div class="cc-modal-time-input-wrapper">
                          <div class="cc-modal-appointmentList-label-time">End</div>
                          <div class="cc-modal-time-input-container">
                            <div class="cc-modal-time-input" blocktimestart="hour">
                              <apex:selectList value="{!new_time_block.End_Hour__c}" size="1" style="height:100%;" onchange="refresh_room_block_modal();">
                                <apex:selectOptions value="{!hour_options}" />
                              </apex:selectList>
                            </div>
                            <div class="cc-modal-time-input" blocktimestart="minutes">
                              <apex:selectList value="{!new_time_block.End_Minute__c}" size="1" style="height:100%;" onchange="refresh_room_block_modal();">
                                <apex:selectOptions value="{!minute_options}" />
                              </apex:selectList>
                            </div>
                            <div class="cc-modal-time-input" blocktimestart="ampm">
                              <apex:selectList value="{!eprefix}" size="1" style="height:100%;" onchange="refresh_room_block_modal();">
                                <apex:selectOptions value="{!suffix_options}" />
                              </apex:selectList>
                            </div>
                          </div>
                        </div>
                        <!-- end appt -->
                        <!-- start appt -->
                        <div class="cc-modal-time-input-wrapper">
                          <div class="cc-modal-appointmentList-label-time">Reason</div>
                          <div class="cc-modal-time-input-container">
                            <div class="cc-modal-time-input" blocktimereason="">
                              <apex:selectList value="{!new_time_block.Block_Reason__c}" size="1" style="height:100%;width:100%;">
                                <apex:selectOptions value="{!room_block_reason_list}" />
                              </apex:selectList>
                            </div>
                          </div>
                        </div>
                        <!-- end appt -->
                        <!-- start appt -->
                        <div class="cc-modal-time-input-wrapper" style="width:100%;">
                          <div class="cc-modal-appointmentList-label-time">Note</div>
                          <div class="cc-modal-time-input-container" style="width:100%;">
                            <div class="cc-modal-time-input" blocktimereason="" style="width:100%;">
                              <apex:inputfield value="{!new_time_block.Block_Note__c}" style="width:100%;" />                                
                            </div>
                          </div>
                        </div>
                        <!-- end appt -->
                        
                        <!-- start warning -->
                        <apex:outputpanel layout="block" styleclass="cc-block-warningMessage" rendered="{!if(estimated_appointment_conflicts.size>0,true,false)}">
                          <div onclick="open_con_modal();">There are <span>{!estimated_appointment_conflicts.size} appointments</span> in this time block.</div>
                          <div>These appointments will be added to the pending reschedule queue</div>
                        </apex:outputpanel>
                        <!-- end warning -->
                        <!-- start appt -->
                        <div class="cc-blockTime-button-container">              
                          <!-- start option -->
                          <div class="">
                            <a class="cc-modal-appointmentList-label cc-modal-blockTime-button" onclick="save_rblock();"><i class="ccf-save"></i>Save</a>
                          </div>                          
                        </div>
                        <!-- end appt -->
                      </div>
                    </apex:outputpanel>
                    
                    <!-- Cycle through current blocks -->     	
                    <apex:outputpanel layout="block" styleclass=" cc-blocks-room-current">Current room blocks</apex:outputpanel>
                    <!-- start status content -->
                    <apex:repeat var="block" value="{!current_room_time_blocks}">
                      <div class="cc-modal-appointmentList-container cc-perio-block-summary" style="display:flex;">
                      
                        <!-- start appt -->                        
                        
                        <div class="cc-modal-time-input-wrapper">
                          <div class="cc-modal-appointmentList-label-time">Start</div>
                          <div class="cc-modal-time-input-container">
                            <apex:outputpanel layout="block" styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,false,true)}">
                              <apex:outputtext value="{!if(block.Start_Hour_Int__c<=12,block.Start_Hour__c,(block.Start_Hour_Int__c-12))}" />:
                              <apex:outputtext value="{!if(len(block.Start_Minute__c)<2,'0' + block.Start_Minute__c,block.Start_Minute__c)}" />&nbsp;
                              <apex:outputtext value="{!if(block.Start_Hour_Int__c<12,'AM','PM')}" />
                            </apex:outputpanel>
                            <apex:outputpanel layout="block" styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,true,false)}">                          
                              <apex:selectList value="{!shour_holder}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                                <apex:selectOptions value="{!hour_options}" />
                              </apex:selectList>
                              <apex:selectList value="{!new_time_block.Start_Minute__c}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                                <apex:selectOptions value="{!minute_options}" />
                              </apex:selectList>
                              <apex:selectList value="{!sprefix}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                                <apex:selectOptions value="{!suffix_options}" />
                              </apex:selectList>                          
                            </apex:outputpanel>                        
                          </div>
                        </div>
                        <!-- end appt -->
                        <!-- start appt -->
                        <div class="cc-modal-time-input-wrapper">
                          <div class="cc-modal-appointmentList-label-time">End</div>
                          <div class="cc-modal-time-input-container">
                            <apex:outputpanel layout="block"  styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,false,true)}">
                              <apex:outputtext value="{!if(block.End_Hour_Int__c<=12,block.End_Hour__c,(block.End_Hour_Int__c-12))}" />:
                              <apex:outputtext value="{!if(len(block.End_Minute__c)<2,'0' + block.End_Minute__c,block.End_Minute__c)}" />&nbsp;
                              <apex:outputtext value="{!if(block.End_Hour_Int__c<12,'AM','PM')}" />
                            </apex:outputpanel>
                            <apex:outputpanel layout="block" styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,true,false)}">                          
                              <apex:selectList value="{!ehour_holder}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                                <apex:selectOptions value="{!hour_options}" />
                              </apex:selectList>
                              <apex:selectList value="{!new_time_block.End_Minute__c}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                                <apex:selectOptions value="{!minute_options}" />
                              </apex:selectList>
                              <apex:selectList value="{!eprefix}" size="1" style="height:100%;" onchange="refresh_doctor_block_modal();">
                                <apex:selectOptions value="{!suffix_options}" />
                              </apex:selectList>                          
                            </apex:outputpanel> 
                          </div>
                        </div>
                        <!-- end appt -->
                        <!-- start appt -->
                        <div class="cc-modal-time-input-wrapper">
                          <div class="cc-modal-appointmentList-label-time">Reason</div>
                          <div class="cc-modal-time-input-container">
                            <apex:outputpanel layout="block" styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,false,true)}">
                              <apex:outputtext value="{!block.Block_Reason__c}" />
                            </apex:outputpanel>
                            <apex:outputpanel layout="block" styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,true,false)}">
                              <apex:selectList value="{!new_time_block.Block_Reason__c}" size="1" style="height:100%;width:100%;">
                                <apex:selectOptions value="{!room_block_reason_list}" />
                              </apex:selectList>                          
                            </apex:outputpanel>                        
                          </div>
                        </div>
                        <!-- end appt -->
                        <!-- start appt -->
                        <div class="cc-modal-time-input-wrapper" style="width:100%;">
                          <div class="cc-modal-appointmentList-label-time">Note</div>
                          <div class="cc-modal-time-input-container" style="width:100%;">
                            <apex:outputpanel layout="block" styleclass="cc-modal-time-input" rendered="{!if(block.id==current_edit_id,false,true)}">
                              <apex:outputtext value="{!block.Block_Note__c}" />
                            </apex:outputpanel>
                            <apex:outputpanel layout="block" styleclass="cc-modal-time-input" style="width:100%;" rendered="{!if(block.id==current_edit_id,true,false)}">
                              <apex:inputfield value="{!new_time_block.Block_Note__c}" style="width:100%;" />                                
                            </apex:outputpanel>                        
                          </div>
                        </div>
                        <!-- end appt -->
                    
                        <apex:outputpanel layout="block" styleclass="cc-block-warningMessage" rendered="{!if(block.id==current_edit_id && display_conflicts.size>0,true,false)}">
                          <div onclick="open_con_modal();">There are <span>{!display_conflicts.size} appointments</span> in this time block.</div>
                          <div>These appointments will be added to the pending reschedule queue</div>
                        </apex:outputpanel>

                        <!-- start appt -->
                        <div class="cc-blockTime-button-container">                      
                          <!-- start option -->
                          <apex:outputpanel layout="block" rendered="{!if(block.id==current_edit_id,false,true)}">
                            <a class="cc-modal-appointmentList-label cc-modal-blockTime-button cc-modal-blockTime-button-rescheduleAll" onclick="remove_rblock('{!block.id}');" style="text-decoration:none;"><i class="ccf-x-circle"></i> Remove block</a>
                          </apex:outputpanel>
                          <!-- end option -->
                          <!-- start option -->
                          <apex:outputpanel layout="block" rendered="{!if(block.id==current_edit_id,false,true)}">
                            <a class="cc-modal-appointmentList-label cc-modal-blockTime-button cc-modal-blockTime-button-reassign" style="text-decoration:none;" onclick="edit_dblock('{!block.id}');"><i class="ccf-clock"></i> Edit times</a>                        
                          </apex:outputpanel> 
                          <!-- end option -->
                          <!-- start option -->
                          <apex:outputpanel layout="block" rendered="{!if(block.id==current_edit_id,true,false)}">
                            <a class="cc-modal-appointmentList-label cc-modal-blockTime-button" onclick="save_rblock();"><i class="ccf-save"></i> Save</a>
                          </apex:outputpanel>
                          <!-- end option -->
                        </div>
                        <!-- end appt -->
                      
                      </div>
                    </apex:repeat>
                    <!-- end status content -->            
                                
                                                                                         
                  </apex:outputpanel>
                  
                  
                  <!-- end modal right side content -->
                </div>
              </div>
            </div>
            <!-- start modal nav menu template -->        
          </div>
        </div>
        <!-- start conflicts modal -->
        <apex:outputpanel layout="block" styleclass="cc-form-confirmReschedule-container" rendered="{!display_conflicts_modal}">
          <div class="cc-form-confirmTrash cc-confirm-wide ">  
            <div>
              <div class="">The following appointments will be added to the pending reschedule list</div>
              <div class="cc-modal-appointmentInfoContainer-wrapper">
                <apex:repeat var="conflict" value="{!display_conflicts}">
                  <div class="cc-modal-appointmentInfoContainer">
                    <div class="cc-modal-appointmentInfo">
                      <div>{!conflict.account__r.name}</div>
                      <div>{!conflict.patient_pot_apt__r.name}</div>
                      <div><apex:outputtext value="{0,date,M/dd/yyyy}" > 
                        <apex:param value="{!conflict.Apt_Date__c}" />
                      </apex:outputtext> &nbsp;
                      <apex:outputtext value="{!if(conflict.Start_Hour_Int__c<=12,conflict.Start_Hour__c,(conflict.Start_Hour_Int__c-12))}" />:
                      <apex:outputtext value="{!if(len(conflict.Start_Minute__c)<2,'0' + conflict.Start_Minute__c,conflict.Start_Minute__c)}" />&nbsp;
                      <apex:outputtext value="{!if(conflict.Start_Hour_Int__c<12,'AM','PM')}" /> -&nbsp;
                      <apex:outputtext value="{!if(conflict.End_Hour_Int__c<=12,conflict.End_Hour__c,(conflict.End_Hour_Int__c-12))}" />:
                      <apex:outputtext value="{!if(len(conflict.End_Minute__c)<2,'0' + conflict.End_Minute__c,conflict.End_Minute__c)}" />&nbsp;
                      <apex:outputtext value="{!if(conflict.End_Hour_Int__c<12,'AM','PM')}" />
                      </div>                    
                    </div>            
                  </div>
                </apex:repeat>            
              </div>
            </div>      
            <div class="cc-form-confirmTrash-buttonContainer">
              <div class="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" onclick="close_con_modal();">Close</div>
            </div>
          </div>
        </apex:outputpanel>
      </div>
    </div>    
  </apex:outputpanel>
  <!--End Room Block Modal-->
  
  <!-- Start Pending Resched Modal -->
  <apex:outputpanel layout="block" rendered="{!display_pending_resched_modal}" id="prsched_modal_holder" >  
    <div class="cc-blankModal-wrapper"  style="top: 3.5%; z-index: 10001; opacity: 1;" formtype="blankModal">
      <div class="cc-modal-container" style="box-shadow: rgba(0, 0, 0, 0.74902) 0px 0px 70px -15px;">
        <apex:outputpanel layout="block" styleclass="cc-modal-close">
          <div id="cc-modal-close-button" onclick="close_prmodal();">
            <i class="ccf-cancel-thin cc-color-font-black cc-cursor-hover"></i>
          </div>
        </apex:outputpanel>      
        <div class="cc-modal-content-container" style="height:100%;">
          <div style="width:100%;height:100%;" blockdrtime="" class="">
            <div id="cc-modal-navMenu-id" class="cc-modal-navMenu-container" style="height:90%;">
              <div class="cc-modal-navMenu-list" style="height:100%;">                            
                <div style="height:100%;overflow-y:auto;">         
                  <div class=" cc-cc-modal-nav-row-link cc-modal-leftNav-selected " >
                    <div class="cc-cc-apptInfoRow-appointmentLabel cc-cc-apptInfoHoverId-patient cc-room-hasBlock " >Pending</div>                                       
                  </div>                                         
                </div>
              </div>
              <div class="cc-modal-navMenu-border"> </div>
              <div id="prsched_print_holder" class="cc-modal-navMenu-content-container-wrapper">
                <div class="cc-modal-navMenu-content-header" showdoctorname="" style="display:flex;">
                  There are {!pending_resched_count} appointments that need to be rescheduled.
                  <span class="no_print" style="display: inline-flex;align-self: center;flex-grow: 1;align-content: stretch;padding-right: 80px;justify-content: flex-end;">
                    <i class="ccf-print" style="color: rgb(27, 99, 222);" action="print" onclick="print_a_section('prsched_print_holder');"></i>
                  </span>
                </div>                  
                
                <apex:messages style="color:red;font-style:italics;padding-top:3px;" />                
                <div class="cc-modal-navMenu-content-container">
                  <!-- start modal right side content -->
                  <div class="cc-modal-rightSide-content">                                                  
                    <!-- repeat through resched here -->
                    <apex:repeat var="apt" value="{!pending_resched_apts}">
                      <div class="cc-modal-appointmentInfoContainer">
                        <div class="cc-modal-appointmentInfo">
                          <div class="cc-modal-appointmentInfo-row">
                            <div class="cc-modal-appointmentInfo-label">Patient name:</div>
                            <div class="cc-modal-appointmentInfo-content">{!apt.account__r.name}</div>
                          </div>
                          <div class="cc-modal-appointmentInfo-row">
                            <div class="cc-modal-appointmentInfo-label">Contact Info:</div>
                            <div class="cc-modal-appointmentInfo-content">
                              <apex:outputpanel style="padding-right:20px;" rendered="{!if(apt.account__r.phone!='',true,false)}">H: {!apt.account__r.phone}</apex:outputpanel>
                              <apex:outputpanel style="padding-right:20px;" rendered="{!if(apt.account__r.personmobilephone!='',true,false)}">M: {!apt.account__r.personmobilephone}</apex:outputpanel>
                              <apex:outputpanel rendered="{!if(apt.account__r.Email__c!='',true,false)}">{!apt.account__r.Email__c}</apex:outputpanel>
                            </div>
                          </div>
                          <div class="cc-modal-appointmentInfo-row">
                            <div class="cc-modal-appointmentInfo-label">Appointment:</div>
                            <div class="cc-modal-appointmentInfo-content">{!apt.patient_pot_apt__r.name}</div>
                          </div>
                          <div class="cc-modal-appointmentInfo-row">
                            <div class="cc-modal-appointmentInfo-label">Assigned doctor:</div>
                            <div class="cc-modal-appointmentInfo-content">{!apt.doctor__r.name}</div>
                          </div>
                          <div class="cc-modal-appointmentInfo-row">
                            <div class="cc-modal-appointmentInfo-label">Scheduled:</div>
                            <div class="cc-modal-appointmentInfo-content">
                              <apex:outputtext value="{0,date,M/dd/yyyy}" > 
                                <apex:param value="{!apt.Apt_Date__c}" />
                              </apex:outputtext>                            
                            </div>
                          </div>                          
                          <div class="cc-modal-appointmentInfo-row">
                            <div class="cc-modal-appointmentInfo-label">Status:<br />
                              <apex:outputpanel layout="block">
                                <a class="cc-modal-appointmentList-label cc-modal-blockTime-button" onclick="save_status_update();"><i class="ccf-save"></i> Save</a>
                              </apex:outputpanel>
                            </div>
                            <div class=" cc-modal-appointmentInfo-content-textAreaContainer">
                              <apex:inputfield value="{!apt.Status_Updates__c}" />
                            </div>
                          </div> 
                          <div class="cc-modal-appointmentInfo-row">
                            <div class="cc-reschedule-actionContainer" style="display: block;">
                              <div class="cc-reschedule-searchAvailableTimes-container">
                                <div class="cc-modal-rescheduleModal-button" onclick="confirm_pending_cancel('{!apt.id}');">
                                  <i class="ccf-x-circle"></i> Cancel appointment
                                </div>
                                <div class="cc-modal-rescheduleModal-button" onclick="pending_resched_search('{!apt.id}');">
                                  <i class="ccf-search"></i> Search times
                                </div>
                                <!-- <div class="cc-modal-rescheduleModal-button" modalaction="manualSchedule">
                                  <i class="ccf-calendar"></i> Manual schedule
                                </div> -->                                
                              </div>
                            </div>
                          </div>
                        </div>
                        
                        <!--Start Reschedule Apt Search View-->
                       <apex:outputpanel layout="block" rendered="{!if(block_view=='Reschedule' && current_edit_id == apt.id,true,false)}" >
                         <apex:outputpanel layout="block" styleclass="cc-patient-modal-schedule-search-container" style="margin-left:30px;" >
                           <div onclick="open_prmodal();">
                             <div><i class="ccf-undo"></i> Back</div>    
                           </div>                                                                            
                           <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences" style="padding-bottom:1em;" id="apt_search_top_holder2">
                             <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences-row">
                               <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences-label">Time:</apex:outputpanel>
                               <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_open}" />&nbsp;8-10AM</label></apex:outputpanel>
                               <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_morning}" />&nbsp; 10-12PM</label></apex:outputpanel>
                               <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_noon}" />&nbsp; 12-2PM</label></apex:outputpanel>
                               <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_afternoon}" />&nbsp; 2-4PM</label></apex:outputpanel>
                               <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_close}" />&nbsp; 4-6PM</label></apex:outputpanel>
                             </apex:outputpanel>
                             <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences-row">
                               <apex:outputpanel layout="block">Day:</apex:outputpanel>
                               <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_monday}"  /> Monday</label></apex:outputpanel>
                               <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_tuesday}"  /> Tuesday</label></apex:outputpanel>
                               <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_wednesday}" /> Wednesday</label></apex:outputpanel>
                               <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_thursday}" /> Thursday</label></apex:outputpanel>
                               <apex:outputpanel layout="block"><label><apex:inputCheckbox value="{!search_friday}" /> Friday</label></apex:outputpanel>
                             </apex:outputpanel>
                             <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences-row">
                               <apex:outputpanel layout="block">
                                 <div>Month:</div>
                                 <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences-month-container">              
                                   <apex:selectList value="{!month_filter}" size="1">
                                     <apex:selectOptions value="{!month_option_list}" />
                                   </apex:selectList>
                                 </apex:outputpanel>
                               </apex:outputpanel>
                               <div style="min-width:50px;">&nbsp;</div>
					           <div>
					             <div style="padding-right:5px;">Doctor :</div>
					             <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-preferences-month-container">              
					               <apex:selectList value="{!doctor_filter}"  size="1">
					                 <apex:selectOptions value="{!doctor_search_list}" />
					               </apex:selectList>
					             </apex:outputpanel>
					           </div>
					           <div style="min-width:50px;">&nbsp;</div>
					           <div>
					             <div class="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" onclick="search_all_apts2();" style="margin:0px;padding:5px;background-color:#337ab7;margin-right:30px;">Search All</div>
					             <div class="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" onclick="search_apts();" style="margin:0px;padding:5px;background-color: rgb(82, 204, 105);color: white;text-align: center;border-radius: 4px;transition: .25s;">Search</div> 
					           </div>
                             </apex:outputpanel>
                           </apex:outputpanel> <!--end search preferences-->

                  
                           <!--Start search results container-->
                           <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-results" id="apt_search_results_holder">
                             <apex:outputpanel layout="block" styleclass="cc-patient-schedule-search-results-row-container"  style="opacity:1;">
                               <div class="sresults_header">
				                 <span class="sresults_text">{!search_pager.search_results_header}</span> 
				                 <span class="spacer">&nbsp;</span>
				                 <apex:outputpanel layout="block" styleclass="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" style="margin:0px;padding:5px;background-color:#337ab7;margin-right:30px;" rendered="{!search_pager.allow_prev}" onclick="prev_page();">Prev</apex:outputpanel>              
				                 <apex:outputpanel layout="block" styleclass="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" style="margin:0px;padding:5px;background-color:#337ab7;margin-right:30px;" rendered="{!search_pager.allow_next}" onclick="next_page();">Next</apex:outputpanel> 
				               </div> 
                               <!--repeat through search dates -->     
                               <apex:repeat var="dheader" value="{!apt_search_results}" >
                                 <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-row">
                                   <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-header">
                                     <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-date-container">{!dheader.display_date}</apex:outputpanel>
                                     <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-lab-container-old">
                                       <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-lab-button-old cc-modal-searchResults-lab-button-{!dheader.current_lab_class}-old">
                                         <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-lab-icon-old"><i class="ccf-lab"></i></apex:outputpanel>
                                         <apex:outputpanel >{!dheader.current_lab_time_display}</apex:outputpanel>
                                       </apex:outputpanel>
                                       &nbsp; to &nbsp;
                                       <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-lab-button-old cc-modal-searchResults-lab-button-{!dheader.projected_lab_class}-old">
                                         <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-lab-icon-old"><i class="ccf-lab"></i></apex:outputpanel>
                                         <apex:outputpanel >{!dheader.projected_lab_time}</apex:outputpanel>
                                       </apex:outputpanel>                            
                                     </apex:outputpanel>            
                                   </apex:outputpanel>
                                 </apex:outputpanel>
                        
                                 <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-content">
                                   <!--repeat through possible blocks here-->
                                   <apex:repeat var="ablock" value="{!dheader.match_list}">
                                     <apex:outputpanel layout="block" styleclass="cc-modal-searchResults-button " onclick="reschedule_apt('{!ablock.si.Clinical_Apt_Calendar__c}',{!ablock.stime},'{!ablock.si.clinical_doctor_inventory__r.User__c}');">
                                       <apex:outputpanel styleclass="cc-modal-searchResults-button-content">
                                         <apex:outputtext value="{!ablock.apt_label}" escape="false" />
                                       </apex:outputpanel>
                                     </apex:outputpanel>
                                   </apex:repeat>
                                   <!--end block repeat-->
                                 </apex:outputpanel>
                               </apex:repeat>
                               <!--end date repeat-->
                               <div class="sresults_header">
					             <span class="sresults_text">{!search_pager.search_results_header}</span> 
					             <span class="spacer">&nbsp;</span>
					             <apex:outputpanel layout="block" styleclass="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" style="margin:0px;padding:5px;background-color:#337ab7;margin-right:30px;" rendered="{!search_pager.allow_prev}" onclick="prev_page();">Prev</apex:outputpanel>              
					             <apex:outputpanel layout="block" styleclass="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" style="margin:0px;padding:5px;background-color:#337ab7;margin-right:30px;" rendered="{!search_pager.allow_next}" onclick="next_page();">Next</apex:outputpanel> 
					           </div>
                             </apex:outputpanel>                      
                           </apex:outputpanel>      
                           <!-- end schedule search container -->
                         </apex:outputpanel>
                       </apex:outputpanel>
                       <!--End Reschedule Apt Search View-->
 
                       <apex:outputpanel layout="block" styleclass="cc-form-confirmTrash-container" rendered="{!if(block_view=='Cancel' && current_edit_id==apt.id,true,false)}">
                         <div class="cc-form-confirmTrash"> 
                           <div>Cancel this appointment?</div>
                             <div class="cc-form-confirmTrash-buttonContainer">
                              <div class="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" onclick="open_prmodal();">Back</div>
                              <div class="cc-form-confirmTrash-button cc-form-confirmTrash-button-confirm" onclick="cancel_pending_resched();">Confirm</div>
                            </div>
                          </div>
                        </apex:outputpanel>
                      </div>                                                              
                    </apex:repeat>
                    <!-- end repeat here -->
                  </div>
                </div>
              </div>
            </div>
            <!-- start modal nav menu template -->        
          </div>
        </div>        
      </div>
    </div>    
  </apex:outputpanel>
  <!--End Pending Resched Modal -->

  <!-- Start Calendar Note Modal -->
  <apex:outputpanel layout="block" rendered="{!display_note_modal}" id="note_modal_holder" >  
    <div class="cc-blankModal-wrapper"  style="top: 3.5%; z-index: 10001; opacity: 1;" formtype="blankModal">
      <div class="cc-modal-container" style="box-shadow: rgba(0, 0, 0, 0.74902) 0px 0px 70px -15px;">
        <apex:outputpanel layout="block" styleclass="cc-modal-close">
          <div id="cc-modal-close-button" onclick="close_notemodal();">
            <i class="ccf-cancel-thin cc-color-font-black cc-cursor-hover"></i>
          </div>
        </apex:outputpanel>      
        <div class="cc-modal-content-container" style="height:100%;">
          <div id="" style="width:100%;height:100%;" blockdrtime="" class="">
            <div id="cc-modal-navMenu-id" class="cc-modal-navMenu-container" style="height:90%;">              
              <div class="cc-modal-navMenu-content-container-wrapper">
                <div class="cc-modal-navMenu-content-header">
                  
                </div>                  
                                
                <div class="cc-modal-navMenu-content-container" style="padding-top:1em;">
                  <!-- start modal right side content -->
                  <div class="cc-modal-rightSide-content" style="padding-top:30px;">
                    <div style="font-size:16pt;font-weight:400;width:200px;padding-bottom:1em;">New Calendar Note</div>
                    <apex:messages style="color:red;font-style:italics;padding-top:3px;" />
                    <apex:inputfield value="{!cal_note.Note_Date__c}" type="date" />
                    <span class="spacer">&nbsp;</span>                    
                    <apex:inputfield value="{!cal_note.Calendar_Note__c}"  onfocus="if(this.value=='Enter Note Here') {this.value='';}" style="width:50%;"/><span class="spacer">&nbsp;</span>                                        
                    <div class="cc-modal-appointmentInfo-row">                                    
                      <apex:outputpanel layout="block">
                        <a class="cc-modal-appointmentList-label cc-modal-blockTime-button" onclick="save_cnote();">
                          <i class="ccf-save"></i> Save
                        </a>
                      </apex:outputpanel>
                    </div>                                            
                  </div>
                </div>
              </div>
            </div>
            <!-- start modal nav menu template -->        
          </div>
        </div>        
      </div>
    </div>    
  </apex:outputpanel>
  <!--End Calendar Modal -->
  
  <!---START Top Level Confirmation Modal------->
  <apex:outputpanel layout="block" rendered="{!confirmation_modal_display}">
  <apex:outputpanel layout="block" styleclass="cc-patient-patient-search-wrapper" style="z-index: 1100; opacity: 1;">
    <apex:outputpanel layout="block" styleclass="cc-patient-patient-search-container" style="box-shadow: rgba(0, 0, 0, 0.74902) 0px 0px 70px -15px;height:200px;width:50%;">
      <apex:outputpanel layout="block" styleclass="cc-patient-patient-search-close">
        <div id="cc-patient-patient-search-close-button" onclick="close_confirm_pop();">
          <i class="ccf-cancel-thin cc-color-font-black cc-cursor-hover"></i>
        </div>
      </apex:outputpanel>
      <apex:outputpanel layout="block" styleclass="cc-patient-patient-search-info" style="width: 100%; text-align: center; padding-top: 10px;">
        <apex:outputtext value="{!modal_out}" escape="false" /><br />

        <apex:outputpanel layout="block"  styleclass="cc-form-confirmTrash-buttonContainer" rendered="{!if(modal_type=='clipboard',true,false)}">
          <div class="cc-form-confirmTrash-button cc-form-confirmTrash-button-cancel" onclick="close_confirm_pop();">Cancel</div>
          <div class="cc-form-confirmTrash-button cc-form-confirmReschedule-button-confirm" onclick="add_to_board('{!apt_block.id}');">Confirm</div>
        </apex:outputpanel>

      </apex:outputpanel>
    </apex:outputpanel>
  </apex:outputpanel>
  </apex:outputpanel>
  <!--End Top Level Confirmation Modal------------------>
  
  <div class="cal_footer no-print">
    <apex:outputtext value="{!patient_status_output}" escape="false" />
  </div>

  </apex:outputPanel> <!-- end cc-clinical-calendar-container -->
</apex:outputPanel> <!--end cc-clinical-calendar-wrapper-->

</apex:outputpanel>

<script>  
  function refresh_calendar() { 
    calendar_refresh();  
    setTimeout("refresh_calendar()",300000); 
  }
  
  function refresh_top_nav() { 
    nav_bar_refresh();  
    setTimeout("refresh_top_nav()",600000); 
  }  

  window.onload = function() { 
    setTimeout("refresh_calendar();",300000);
    setTimeout("refresh_top_nav();",600000);    
  }
  
</script>

</apex:form>
</body>
</apex:page>